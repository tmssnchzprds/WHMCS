var blendClientLimits={refs:{primary:"#clientLimitNotification",form:"#clientLimitNotification form",dismiss:"#btnClientLimitNotificationDismiss",dontshow:"#btnClientLimitNotificationDontShowAgain"},init:function(){var t=blendClientLimits;$(t.refs.form).submit(function(e){e.preventDefault(),t.go($(this))}),$(t.refs.dismiss).click(function(e){e.preventDefault(),t.dismiss("clientlimitdismiss")}),$(t.refs.dontshow).click(function(e){e.preventDefault(),t.dismiss("clientlimitdontshowagain")})},dismiss:function(e){$(this.refs.primary).fadeOut(),WHMCS.http.jqClient.post(window.location.href,e+"=1&name="+$(this.refs.primary).find(".panel-title span").html())},go:function(t){var e=t.data("fetchUrl"),a=t.find('button[type="submit"]'),n=a.html();a.css("width",a.css("width")).prop("disabled",!0).html('<i class="fas fa-spinner fa-spin"></i>'),WHMCS.http.jqClient.post(e,t.serialize(),function(e){t.find(".input-license-key").val(e.license_key),t.find(".input-member-data").val(e.member_data),t.off("submit").submit(),a.html(n).removeProp("disabled")},"json")}},blendGlobal=($(document).ready(blendClientLimits.init),{refs:{frmNotes:"#frmMyNotes",modalNotes:"#modalMyNotes"},init:function(){var t=blendGlobal;$(t.refs.frmNotes).submit(function(e){e.preventDefault(),$(t.refs.modalNotes).modal("hide"),WHMCS.http.jqClient.post($(this).attr("action"),$(this).serialize())}),$("div.modal").on("shown.bs.modal",function(){var e=jQuery(this).find("input:not(input[type=checkbox],input[type=radio],input[type=hidden]),button.btn-primary");0<e.length&&$(e).first().focus()}),lightbox.init()}}),blendIntelliSearch=($(document).ready(blendGlobal.init),{activeSearch:!1,typingTimer:null,refs:{body:"body",form:"#intelliSearchForm",value:"#inputIntelliSearchValue",close:"#btnIntelliSearchClose",results:"#intelligentSearchResults",searchResults:"#intelligentSearchResults .search-results",resultheadings:"#intelligentSearchResults h5",expand:"#intelliSearchExpand",realtime:"#intelliSearchRealtime",hideinactive:"#intelliSearchHideInactiveSwitch",expandbtn:"#intelligentSearchResults .search-more-results",searchMoreTpl:'.search-more-results[data-type="placeholder"]'},init:function(){var a=blendIntelliSearch;$(a.refs.value).focus(function(e){a.inputExpand()}),$(a.refs.value).keyup(function(){a.inputKeyUp()}),$(a.refs.form+" form").submit(function(e){e.preventDefault(),a.search()}),$(document).keyup(function(e){27===e.keyCode&&$("#intelliSearchForm").hasClass("active")&&a.close()}),$(a.refs.body).click(function(e){$(a.refs.form).hasClass("active")&&!$(e.target).closest(a.refs.form+","+a.refs.results).length&&a.close()}),$(a.refs.close).click(function(e){a.close()}),$(a.refs.realtime).bootstrapSwitch().on("switchChange.bootstrapSwitch",function(e,t){WHMCS.http.jqClient.post($(this).data("url"),"token="+csrfToken+"&autosearch="+t)}),$(a.refs.hideinactive).bootstrapSwitch().on("switchChange.bootstrapSwitch",function(e,t){t=t?1:0;$("#intelliSearchHideInactive").attr("value",t),a.search()}),$(a.refs.resultheadings).click(function(e){a.toggleResultSet($(this))}),$(blendIntelliSearch.refs.results+" .collapse-toggle").click(function(e){e.preventDefault(),blendIntelliSearch.toggleAllResultSets()}),$(document).on("click",blendIntelliSearch.refs.expandbtn,function(e){e.preventDefault(),blendIntelliSearch.expandResults($(this),$(this).data("type"))})},inputExpand:function(){$("#intelliSearchForm").addClass("active");var e,t=$(this.refs.form);t.data("expanded")||((e=t.offset()).left-=100,t.data("expanded",!0).data("leftpos",e.left),$(this.refs.value).val()&&$(this.refs.results).slideDown())},inputKeyUp:function(){clearTimeout(this.typingTimer),3<=$(this.refs.value).val().replace(/\s/g,"").length&&$("#intelliSearchRealtime").is(":checked")&&(this.typingTimer=setTimeout(this.search,750))},showLoader:function(){$(this.refs.form).find(".loader").removeClass("fa-search").addClass("fa-spinner fa-spin")},endLoader:function(){$(this.refs.form).find(".loader").addClass("fa-search").removeClass("fa-spinner fa-spin")},resetResults:function(){$(this.refs.searchResults).find("h5").hide().end().find("ul li:not(.template)").remove().end().find(".search-more-results").remove()},getResultTypes:function(){var t=[];return $(".search-results ul").each(function(e){t.push($(this).data("type"))}),t},getResultTarget:function(e){return $(this.refs.searchResults+' ul[data-type="'+e+'"]')},getNumResults:function(e){return this.getResultTarget(e).find("li:not(.template)").length},getTotalResults:function(){return $(this.refs.searchResults+" ul").find("li:not(.template)").length},getTemplateByType:function(e){e=this.getResultTarget(e).find("li.template").clone();return e.removeClass("template"),e},renderResults:function(a,e){var n,t;0!=e.length&&(n=this.getTemplateByType(a),$.each(e,function(e,t){t="string"==typeof t?"<li>"+t+"</li>":blendIntelliSearch.mergeResultData(n.clone(),t);blendIntelliSearch.addResult(a,t)}),t=this.getNumResults(a),this.getResultTarget(a).prev("h5").show().find(".count").html(t),e[0].totalResults>t)&&(e=e[0].totalResults-t,this.showExpand(a,e))},showExpand:function(e,t){$(this.refs.expand).val()!=e&&((cloneRow=$(this.refs.searchMoreTpl).clone()).attr("data-type",e),cloneRow.removeClass("hidden"),stringValue=(stringValue=cloneRow.html()).replace(":count",t),cloneRow.html(stringValue),this.addResult(e,cloneRow))},addResult:function(e,t){this.getResultTarget(e).append(t)},mergeResultData:function(e,t){return str=e.html(),$.each(t,function(e,t){str=str.replace(new RegExp("\\["+e+"\\]","g"),t)}),e.html(str)},search:function(e){var n=blendIntelliSearch;n.activeSearch||(n.activeSearch=!0,n.showLoader(),$(n.refs.results).is(":visible")||$(n.refs.results).slideDown(),$(n.refs.expand).val(e),WHMCS.http.jqClient.jsonPost({url:$(n.refs.form+" form").attr("action"),data:$(n.refs.form+" form").serialize(),success:function(a){$(n.refs.expand).val()||n.resetResults(),$.each(n.getResultTypes(),function(e,t){n.renderResults(t,a[t])}),n.searchComplete(!0)},warning:function(e){$(n.refs.results).find(".search-warning").find(".warning-msg").html(e),n.searchComplete(!1,".search-warning")},error:function(e){n.searchComplete(!1,".error")},fail:function(e){n.searchComplete(!1,".session-expired")}}))},searchComplete:function(e,t){e&&(e=this.getTotalResults(),$(this.refs.results).find(".search-result-count").html(e),t=0===e?".search-no-results":".search-results"),$(this.refs.results).find(".outcome").not(t).hide(),$(this.refs.results).find(t).is(":visible")||$(this.refs.results).find(t).fadeIn(),this.endLoader(),this.activeSearch=!1},expandResults:function(e,t){e.remove(),this.search(t)},close:function(){$("#intelliSearchForm").removeClass("active");var t=$(this.refs.form);$(this.refs.results).slideUp(),t.css({width:"",left:$(this.refs.form).data("leftpos")}).removeClass("active full-width").delay(100).queue(function(e){t.css({position:"",top:"",left:""}),e()}).data("expanded",!1),$(".logo").focus(),clearTimeout(this.typingTimer)},toggleResultSet:function(e){var t=e.next("ul"),t=(t.is(":visible")?(t.slideUp(),e.addClass("collapsed")):(t.slideDown(),e.removeClass("collapsed")),$(this.refs.results+" h5:visible").length),e=$(this.refs.results+" h5:visible:not(.collapsed)").length,a=$(this.refs.results+" .collapse-toggle");0==e?a.html(a.data("lang-expand")):t==e&&a.html(a.data("lang-collapse"))},toggleAllResultSets:function(){var e=$(this.refs.results+" h5:visible:not(.collapsed)").length,t=$(this.refs.results+" .collapse-toggle");0==e?($(this.refs.results+" ul").slideDown(),$(this.refs.results+" h5").removeClass("collapsed"),t.html(t.data("lang-collapse"))):($(this.refs.results+" ul").slideUp(),$(this.refs.results+" h5").addClass("collapsed"),t.html(t.data("lang-expand")))}});$(document).ready(blendIntelliSearch.init);const desktop=window.matchMedia("(min-width: 1200px)"),animationSpeed=250;$(document).ready(()=>{const e=document.querySelector(".navigation"),i=document.querySelector(".navbar-new"),t=document.querySelector(".navigation .nav-toggle"),a=document.querySelector("[data-quicksearch]");var n=document.querySelector("#intelliSearchForm input.quicksearch");const r=document.querySelector("#overlay"),o=()=>{t.classList.remove("active"),i.classList.remove("active"),i.classList.add("active-out"),setTimeout(()=>{i.classList.remove("active-out"),r.classList.remove("active")},animationSpeed),document.body.classList.remove("mobile-active")},s=(document.addEventListener("click",t=>{var n=t.target.closest("[data-dropdown-btn]");if(n||null==t.target.closest("[data-dropdown]")){let a;if(n)if(t.preventDefault(),desktop.matches)(a=t.target.closest("[data-dropdown]")).classList.toggle("active"),a.querySelectorAll(".has-dropdown").forEach(e=>{const t=e.querySelector("a[data-dropdown-btn]").getAttribute("href");e.addEventListener("click",()=>{window.location.href=t}),e.addEventListener("mouseenter",()=>{e.classList.add("active")}),e.addEventListener("mouseleave",()=>{setTimeout(()=>{e.matches(":hover")||e.classList.remove("active")},35)})});else{let e=t.target.closest("[data-dropdown]").querySelector("[data-dropdown-menu]").parentElement.parentElement;a=t.target.closest("[data-dropdown]").querySelector("[data-dropdown-menu]").cloneNode(!0),t.target.closest(".nav-icons")&&(e=document.querySelector(".navbar-new > ul"));n=t.target.closest("[data-dropdown-btn]").dataset.title,t=document.createElement("li");t.innerHTML=`<a class="menu-back-button"><i class="ph ph-caret-left"></i> ${n}</a>`,t.addEventListener("click",()=>{a.classList.add("menu-secondary-hidden"),setTimeout(()=>{e.classList.remove("menu-primary-hidden")}),setTimeout(()=>{i.removeChild(i.lastElementChild)},500)}),a&&(a.classList.add("menu-secondary-hidden"),a.prepend(t),e.classList.add("menu-primary-hidden"),i.appendChild(a),setTimeout(()=>{a.classList.remove("menu-secondary-hidden")}))}else{n=i.querySelector("[data-dropdown].active");desktop.matches&&n&&n.classList.remove("active")}document.querySelectorAll("[data-dropdown].active").forEach(e=>{e!==a&&a!==(e=>{let t;return e.querySelectorAll("[data-dropdown-menu] [data-dropdown]").forEach(e=>{e===a&&(t=e)}),t})(e)&&e.classList.remove("active")})}}),n.addEventListener("focus",()=>{o(),e.classList.add("search-active"),a.classList.add("active")}),n.addEventListener("blur",()=>{e.classList.remove("search-active"),a.classList.remove("active")}),t.addEventListener("click",e=>{t.classList.toggle("active"),i.classList.contains("active")?o():i.classList.add("active"),r.classList.toggle("active"),document.body.classList.toggle("mobile-active"),r.addEventListener("click",()=>{o()})}),()=>{desktop.matches&&i.lastElementChild.hasAttribute("data-dropdown-menu")?(i.removeChild(i.lastElementChild),i.querySelector("ul").className=""):desktop.matches?(t.classList.remove("active"),i.classList.remove("active"),r.classList.remove("active"),document.querySelector(".navigation .menu-right").prepend(a)):(document.querySelectorAll("[data-dropdown].active").forEach(e=>{e.classList.remove("active")}),document.querySelector(".mobile-nav .quick-search-item").append(a))});s(),window.addEventListener("resize",()=>{s()})});var blendSidebar={refs:{sidebar:"#sidebar",content:"#contentarea",opener:"#sidebarOpener",closer:"#sidebarClose",collapse:".sidebar-collapse",collapseExpand:"#sidebarCollapseExpand"},init:function(){var t=blendSidebar;$(t.refs.opener).click(function(e){e.preventDefault(),$(this).fadeOut(),$(t.refs.content).removeClass("sidebar-minimized"),$(t.refs.sidebar).delay(400).fadeIn("fast"),WHMCS.http.jqClient.post(whmcsBaseUrl+adminBaseRoutePath+"/search.php","a=maxsidebar")}),$(t.refs.closer).click(function(e){e.preventDefault(),$(t.refs.sidebar).fadeOut("fast",function(){$(t.refs.content).addClass("sidebar-minimized"),$(t.refs.opener).fadeIn()}),WHMCS.http.jqClient.post(whmcsBaseUrl+adminBaseRoutePath+"/search.php","a=minsidebar")}),$(t.refs.collapseExpand).click(function(e){e.preventDefault(),$(this).toggleClass("expanded"),$(t.refs.collapse).slideToggle()})}},blendSlidetray=($(document).ready(blendSidebar.init),{refs:{opener:'*[data-toggle="slide-tray"]',close:'button[data-dismiss="slide-tray"]',backdrop:"slide-tray-backdrop",tray:".slide-tray"},init:function(){var a=blendSlidetray;$(a.refs.opener).click(function(e){e.preventDefault();e=$(this).data("target");$("#"+a.refs.backdrop).length||$(document.createElement("div")).attr("id",a.refs.backdrop).addClass("modal-backdrop nav-modal-backdrop").css("opacity","0.5").css("position","absolute").css("top",0).appendTo("body"),$("#"+a.refs.backdrop).fadeIn(),$("html, body").css("overflow","hidden"),$(e).show(),$(e).hasClass("right")?($(e).css("right",-1*$(e).outerWidth()),$(e).animate({right:0},200)):($(e).css("left",-1*$(e).outerWidth()),$(e).animate({left:0},200))}),$(a.refs.close).click(function(e){e.preventDefault();var t=$(this).closest(a.refs.tray);$(t).hasClass("right")?$(t).animate({right:-1*$(t).outerWidth()},200,function(){$(t).hide(),$("#"+a.refs.backdrop).fadeOut("",function(){$("html, body").css("overflow","auto")})}):$(t).animate({left:-1*$(t).outerWidth()},200,function(){$(t).hide(),$("#"+a.refs.backdrop).fadeOut("",function(){$("html, body").css("overflow","auto")})})})}});function toggleadvsearch(){"hidden"==document.getElementById("searchbox").style.visibility?document.getElementById("searchbox").style.visibility="":document.getElementById("searchbox").style.visibility="hidden"}function populate(e){if(d=document.getElementById("searchfield"),v=e.options[e.selectedIndex].value,d){var t=new Array;if(t.clients=["Client ID","Client Name","Company Name","Email Address","Address 1","Address 2","City","State","Postcode","Country","Phone Number","CC Last Four","Notes"],t.orders=["Order ID","Order #","Client Name","Order Date","Amount"],t.services=["Service ID","Domain","Client Name","Product","Billing Cycle","Next Due Date","Status","Username","Dedicated IP","Assigned IPs","Subscription ID","Notes"],t.domains=["Domain ID","Domain","Client Name","Registrar","Expiry Date","Status","Subscription ID","Notes"],t.invoices=["Invoice #","Client Name","Line Item","Invoice Date","Due Date","Date Paid","Total Due","Status"],t.tickets=["Ticket #","Tag","Subject","Client Name","Email Address"],d.options.length=0,cur=t[e.options[e.selectedIndex].value]){d.options.length=cur.length;for(var a=0;a<cur.length;a++)d.options[a].text=cur[a],d.options[a].value=cur[a];"services"!=v&&"domains"!=v&&"clients"!=v||(document.getElementById("searchfield").selectedIndex=1)}}}function scrollToGatewayInputError(){var e=jQuery(".gateway-errors,.assisted-cc-input-feedback").first();(e.closest("form")||jQuery("form").first()).find('button[type="submit"],input[type="submit"]').prop("disabled",!1).removeClass("disabled").find("i.fas,i.far,i.fal,i.fab").removeAttr("class").addClass("fas fa-arrow-circle-right").find("span").toggle(),e.length&&elementOutOfViewPort(e[0])&&jQuery("html, body").animate({scrollTop:e.offset().top-50},500)}function elementOutOfViewPort(e){var e=e.getBoundingClientRect(),t={};return t.top=e.top<0,t.left=e.left<0,t.bottom=e.bottom>(window.innerHeight||document.documentElement.clientHeight),t.right=e.right>(window.innerWidth||document.documentElement.clientWidth),t.any=t.top||t.left||t.bottom||t.right,t.any}function showCheckoutError(e,t=null){jQuery(".alert-danger").hide();(t=t||jQuery([".checkout-error-feedback","#existingLoginMessage",".gateway-errors",".assisted-cc-input-feedback"].join(", ")).first()).length&&t.html(e).slideDown("fast")}$(document).ready(blendSlidetray.init),function(e){"object"!=typeof e.WHMCS&&(e.WHMCS={hasModule:function(e){return typeof WHMCS[e]!=="undefined"&&Object.getOwnPropertyNames(WHMCS[e]).length>0},loadModule:function(e,t){if(this.hasModule(e))return;WHMCS[e]={};if(typeof t==="function")t.apply(WHMCS[e]);else for(var a in t)if(t.hasOwnProperty(a)){WHMCS[e][a]={};t[a].apply(WHMCS[e][a])}}})}(window),jQuery(document).ready(function(){jQuery(document).on("click",".disable-on-click",function(){var e;jQuery(this).addClass("disabled"),jQuery(this).hasClass("spinner-on-click")&&(e=$(this).find("i.fas,i.far,i.fal,i.fab"),jQuery(e).removeAttr("class").addClass("fas fa-spinner fa-spin"))}).on("click","#openTicketSubmit.disabled",function(){return!1})}),WHMCS.hasModule("adminUtils")||WHMCS.loadModule("adminUtils",function(){return this.getAdminRouteUrl=function(e){return whmcsBaseUrl+"/index.php?rp="+adminBaseRoutePath+e},this.normaliseStringValue=function(e){return e?e.toLowerCase().replace(/\s/g,"-"):""},this.generatePassword=function(e){var t=this.getPasswordCharacterSet();var a="";for(var n=0;e>n;n++)a+=t[this.randomInt(t.length)];return a},this.getPasswordCharacterSet=function(){var e="0123456789"+"abcdefghijklmnopqrstuvwxyz"+"ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"!#$%()*+,-.:;=@_|{ldelim}{rdelim}~";var t=[];for(var a=0;e.length>a;a++){var n=e.charCodeAt(a);if(55296>n||n>=57344){var i=e.charAt(a);if(t.indexOf(i)==-1)t.push(i);continue}if(56320>n?e.length>a+1:false){var r=e.charCodeAt(a+1);if(r>=56320?57344>r:false){var i=e.substring(a,a+2);a++;if(t.indexOf(i)==-1)t.push(i);continue}}throw new Error("Invalid UTF-16")}return t},this.randomInt=function(e){var t=this.randomIntMathRandom(e);t=(t+this.randomIntBrowserCrypto(e))%e;return t},this.randomIntMathRandom=function(e){var t=Math.floor(Math.random()*e);if(0>t||t>=e)throw new Error("Arithmetic exception");return t},this.randomIntBrowserCrypto=function(e){var t=null;if("crypto"in window)t=crypto;else if("msCrypto"in window)t=msCrypto;else return 0;if(!("getRandomValues"in t)||!("Uint32Array"in window)||typeof Uint32Array!="function")t=null;if(t==null)return 0;var a=new Uint32Array(1);do{t.getRandomValues(a)}while(a[0]-a[0]%e>4294967296-e);return a[0]%e},this.ensureElementHasId=function(e,t){e=jQuery(e);if(typeof e.attr("id")==="undefined")e.attr("id",this.generateUniqueIdentifier(t));return this},this.generateUniqueIdentifier=function(e){let t=Math.random().toString(36).replace("0.",e||"x_");if(this.generatedIds.includes(t))return this.generateUniqueIdentifier(e);this.generatedIds.push(t);return t},this.generatedIds=[],this.clearLocalStorage=function(e){if(typeof Storage==="undefined")return;if(e.data("noClear")===true)return;localStorage.removeItem(e.data("localStorageId"))},this}),function(e){WHMCS.hasModule("http")||WHMCS.loadModule("http",e)}({jqClient:function(){return _getSettings=function(e,t,a,n){return"object"==typeof e?e:("function"==typeof t&&(a=t,t=null),{url:e,data:t,success:a,dataType:n})},this.get=function(e,t,a,n){return WHMCS.http.client.request(jQuery.extend(_getSettings(e,t,a,n),{type:"GET"}))},this.post=function(e,t,a,n){return WHMCS.http.client.request(jQuery.extend(_getSettings(e,t,a,n),{type:"POST"}))},this.jsonGet=function(a){a=a||{},this.get(a.url,a.data,function(e){e.warning?(console.log("[WHMCS] Warning: "+e.warning),"function"==typeof a.warning&&a.warning(e.warning)):e.error?(console.log("[WHMCS] Error: "+e.error),"function"==typeof a.error&&a.error(e.error)):"function"==typeof a.success&&a.success(e)},"json").error(function(e,t){console.log("[WHMCS] Error: "+t),"function"==typeof a.fail&&a.fail(t)}).always(function(){"function"==typeof a.always&&a.always()})},this.jsonPost=function(n){n=n||{},this.post(n.url,n.data,function(e,t,a){e.warning?(console.log("[WHMCS] Warning: "+e.warning),"function"==typeof n.warning&&n.warning(e.warning,e,a)):e.error?(console.log("[WHMCS] Error: "+e.error),"function"==typeof n.error&&n.error(e.error,e,a)):"function"==typeof n.success&&n.success(e,a)},"json").fail(function(e,t,a){console.log("[WHMCS] Fail: "+t),"function"==typeof n.fail&&n.fail(t,e.responseJSON,e)}).always(function(e,t,a){"function"==typeof n.always&&n.always(e)})},this},client:function(){var i=this;return _beforeRequest=function(e){return void 0===e.type&&(e.type="GET"),e},this.request=function(e){return e=_beforeRequest(e||{}),jQuery.ajax(e)},jQuery.each(["get","post","put","delete"],function(e,t){var a,n;i[t]=(a=t,n=i,function(e){return(e=e||{}).type=a.toUpperCase(),n.request(e)})}),this}}),WHMCS.hasModule("ui")||WHMCS.loadModule("ui",{confirmation:function(){var t=[];return this.register=function(e){return t.indexOf(e=void 0===e?"[data-toggle=confirmation]":e)<0&&t.push(e),jQuery(e).confirmation({rootSelector:e}),t},this},dataTable:function(){return this.tables={},this.register=function(){var a=this;jQuery("table.data-driven").each(function(e,t){a.getTableById(t.id,void 0)})},this.getTableById=function(e,a){var t,n,i=this,r=jQuery("#"+e);return void 0===i.tables[e]?(void 0===a&&(a={dom:'<"listtable"ift>pl',paging:!1,lengthChange:!1,searching:!1,ordering:!0,info:!1,autoWidth:!0,columns:[],lengthMenu:[10,25,50,100,500,1e3],language:{emptyTable:r.data("langEmptyTable")?r.data("langEmptyTable"):"No records found"}}),jQuery.each(r.data(),function(e,t){void 0!==t&&("ajaxUrl"===e?a.ajax={url:t}:"lengthChange"===e?a.lengthChange=t:"pageLength"===e?a.pageLength=t:"langEmptyTable"===e?(void 0===a.language&&(a.language={}),a.language.emptyTable=t):"langZeroRecords"===e?(void 0===a.language&&(a.language={}),a.language.zeroRecords=t):a.key=t)}),jQuery.each(r.find("th"),function(){void 0===a.columns&&(a.columns=[]),a.columns.push({data:jQuery(this).data("name")})}),i.tables[e]=i.initTable(r,a)):void 0!==a&&(n=(t=i.tables[e]).init(),n=jQuery.extend(n,a),t.destroy(),i.tables[e]=i.initTable(r,n)),i.tables[e]},this.initTable=function(n,e){var e=n.DataTable(e),t=this;return n.data("on-draw")?e.on("draw.dt",function(e,t){var a=n.data("on-draw");"function"==typeof window[a]&&window[a](e,t)}):n.data("on-draw-rebind-confirmation")&&e.on("draw.dt",function(e){t.rebindConfirmation(e)}),e},this.rebindConfirmation=function(e){for(var t=this,a=e.target.id,n=WHMCS.ui.confirmation.register(),i=0,r=n.length;i<r;i++)jQuery(n[i]).on("confirmed.bs.confirmation",function(e){e.preventDefault(),WHMCS.http.jqClient.post(jQuery(e.target).data("target-url"),{token:csrfToken}).done(function(e){"success"!==e.status&&"okay"!==e.status||t.getTableById(a,void 0).ajax.reload()})})},this},clipboard:function(){return this.copy=function(e){e.preventDefault();var e=$(e.currentTarget),t=$(e).data("clipboard-target"),a=$(t).parent();try{var n=$("<textarea>").css("position","fixed").css("opacity","0").css("width","1px").css("height","1px").val($(t).val());a.append(n),n.focus().select(),document.execCommand("copy")}finally{n.remove()}e.tooltip({trigger:"click",placement:"bottom"}),WHMCS.ui.toolTip.setTip(e,"Copied!"),WHMCS.ui.toolTip.hideTip(e)},this},toolTip:function(){this.setTip=function(e,t){var a=e.data("bs.tooltip");return"in"!==a.hoverState&&(a.hoverState="in"),e.attr("data-original-title",t),a.show(),a},this.hideTip=function(e,t){return t=t||2e3,setTimeout(function(){e.data("bs.tooltip").hide()},t)}},jsonForm:function(){return this.managedElements="input,textarea,select",this.initFields=function(e){var t=this;$(e).find(t.managedElements).each(function(){var e=this;$(e).on("keypress change",function(){t.fieldHasError(e)&&t.clearFieldError(e)})})},this.init=function(t){var a=this;a.initFields(t),$(t).on("submit",function(e){e.preventDefault(),e.stopPropagation(),a.clearErrors(t);e=$(t).parents('.modal[role="dialog"]').first();$(e).length&&($(e).on("show.bs.modal hidden.bs.modal",function(){a.clearErrors(t)}),$(e).on("show.bs.modal",function(){$(t)[0].reset()})),WHMCS.http.client.post({url:$(t).attr("action"),data:$(t).serializeArray()}).done(function(e){a.onSuccess(t,e)}).fail(function(e){a.onError(t,e)}).always(function(e){a.onRequestComplete(t,e)})})},this.initAll=function(){var e=this;$('form[data-role="json-form"]').each(function(){e.init(this)})},this.markFieldErrors=function(e,t){var a,n,i=null;for(n in t)t.hasOwnProperty(n)&&(i=t[n]),a=this.managedElements.split(",").map(function(e){return e+'[name="'+n+'"]'}).join(","),a=$(e).find(a),i&&($(a).parents(".form-group").addClass("has-error"),$(a).attr("title",i),$(a).tooltip());$(e).find(".form-group.has-error input[title]").first().tooltip("show")},this.fieldHasError=function(e){return $(e).parents(".form-group").hasClass("has-error")},this.clearFieldError=function(t){try{$(t).tooltip("dispose")}catch(e){$(t).tooltip("destroy")}$(t).parents(".form-group").removeClass("has-error")},this.onSuccess=function(e,t){e=$(e).data("on-success");"function"==typeof e&&e(t.data)},this.onError=function(e,t){t.responseJSON&&t.responseJSON.fields&&"object"==typeof t.responseJSON.fields?this.markFieldErrors(e,t.responseJSON.fields):console.log("Unknown error - please try again later.");e=$(e).data("on-error");"function"==typeof e&&e(t)},this.clearErrors=function(e){var t=this;$(e).find(t.managedElements).each(function(){t.clearFieldError(this)})},this.onRequestComplete=function(e,t){},this},effects:function(){this.errorShake=function(e){var d={},d=$.extend({direction:"left",distance:8,times:3,speed:90},d);return e.each(function(){var e=$(this),t={position:e.css("position"),top:e.css("top"),bottom:e.css("bottom"),left:e.css("left"),right:e.css("right")},a=(e.css("position","relative"),"up"===d.direction||"down"===d.direction?"top":"left"),n="up"===d.direction||"left"===d.direction?"pos":"neg",i={},r={},o={};i[a]=("pos"==n?"-=":"+=")+d.distance,r[a]=("pos"==n?"+=":"-=")+2*d.distance,o[a]=("pos"==n?"-=":"+=")+2*d.distance,e.animate(i,d.speed);for(var s=1;s<d.times;s++)e.animate(r,d.speed).animate(o,d.speed);e.animate(r,d.speed).animate(i,d.speed/2,function(){e.css(t)})})}},markdownEditor:function(){this.editors={},this.counters={},this.register=function(){let a=this;jQuery(".container-markdown-editor").each(function(e,t){void 0===(t=jQuery(t)).attr("id")?console.debug("Element has no id",t):(a.getEditorById(t.attr("id")),a.withTagging(t))})},this.withTagging=function(e){e.is(".editor-tagging")&&e.atwho({at:"@",displayTpl:'<li class="mention-list">${gravatar} ${username} - ${name} (${email})</li>',insertTpl:mentionsFormat,data:e.data("tagging-url"),limit:5})},this.getEditorById=function(e){var t=jQuery("#"+e);return void 0===this.editors[e]&&(this.editors[e]=this.init(t)),this.editors[e]},this.init=function(e){let n=this,i=e.attr("id");var t=i+"-footer";let r="#"+t;var t='<div id="'+t+'" class="markdown-editor-status"></div>',a=void 0===e.data("locale")?"en":e.data("locale");let o=e.data("localStorageId"),s=csrfToken,d=e.data("fetchPreviewUrl");return n.counters[i]=0,e.markdown({footer:t,autofocus:!1,savable:!1,resize:"vertical",iconlibrary:"glyph",language:a,onShow:function(e){let t="",a=!1;"undefined"!=typeof Storage&&(t=localStorage.getItem(o),a=!0,t)&&void 0!==t&&e.setContent(t),jQuery(r).html(n.parseMdeFooter(t,a,"saved"))},onChange:function(e){let t=e.getContent(),a=!1;i=e.$element.attr("id"),"undefined"!=typeof Storage&&(n.counters[i]=3,a=!0,localStorage.setItem(o,t),n.doCountdown(i)),jQuery(r).html(n.parseMdeFooter(t,a))},onPreview:function(e){let t=e.getContent(),a;return jQuery.ajax({url:d,async:!1,data:{token:s,action:"parseMarkdown",content:t},dataType:"json",success:function(e){a=e},method:"POST"}),a.body||""},additionalButtons:[[{name:"groupCustom",data:[{name:"cmdHelp",title:"Help",hotkey:"Ctrl+F1",btnClass:"btn open-modal",icon:{glyph:"fas fa-question-circle",fa:"fas fa-question-circle","fa-3":"icon-question-sign"},callback:function(e){e.$editor.removeClass("md-fullscreen-mode")}}]}]],hiddenButtons:["cmdImage"]}),n.addEventHelpModal(e),e},this.parseMdeFooter=function(e,t,a){void 0===a&&(a="autosaving");let n=[],i=0,r=0;if(e&&(n=e.match(/[^\s]+/g),r=e.split(/\\r\\n|\\r|\\n/).length),n)for(let e=0;e<n.length;e++)19968<=n[e].charCodeAt(0)?i+=n[e].length:i+=1;return'<div class="smallfont">lines: '+r+"&nbsp;&nbsp;&nbsp;words: "+i+(t?'&nbsp;&nbsp;&nbsp;<span class="markdown-save">'+a+"</span>":"")+"</div>"},this.doCountdown=function(e){let t=this;0<=t.counters[e]&&(0===t.counters[e]&&jQuery("span.markdown-save").html("saved"),t.counters[e]--,setTimeout(function(e){t.doCountdown(e)},1e3,e))},this.addEventHelpModal=function(e){return e.parent().find('button[data-handler="bootstrap-markdown-cmdHelp"]').attr("data-modal-title","Markdown Guide").attr("data-modal-size","modal-lg").attr("href",e.data("fetchHelpUrl")),this}}}),WHMCS.hasModule("form")||WHMCS.loadModule("form",function(){return this.checkAllBound=false,this.register=function(){if(!this.checkAllBound){this.bindCheckAll();this.checkAllBound=true}},this.bindCheckAll=function(){var e=".btn-check-all";jQuery("body").on("click",e,function(e){var t=jQuery(e.target);var a=jQuery("#"+t.data("checkbox-container")+' input[type="checkbox"]');if(t.data("btn-check-toggle")){var n="Deselect All";var i="Select All";if(t.data("label-text-deselect"))n=t.data("label-text-deselect");if(t.data("label-text-select"))i=t.data("label-text-select");if(t.hasClass("toggle-active")){a.prop("checked",false);t.text(i);t.removeClass("toggle-active")}else{a.prop("checked",true);t.text(n);t.addClass("toggle-active")}}else if(t.data("btn-toggle-on"))a.prop("checked",true);else a.prop("checked",false)})},this.reloadCaptcha=e=>{if(typeof grecaptcha!=="undefined"){recaptchaValidationComplete=false;grecaptcha.reset();WHMCS.recaptcha.restoreDefaultCallback();return}if(!e)e=jQuery("#inputCaptchaImage");const t=jQuery("#inputCaptcha");if(e.length){e.attr("src",whmcsBaseUrl+"/includes/verifyimage.php?nocache="+(new Date).getTime());t.val("")}},this}),WHMCS.hasModule("selectize")||WHMCS.loadModule("selectize",function(){return $(document).ready(function(){const e=Selectize.prototype.setup;Selectize.prototype.setup=function(){e.apply(this,arguments);const a=this;this.$dropdown.off("mousedown","[data-selectable]");this.$dropdown.on("mouseup","[data-selectable]",function(){return a.onOptionSelect.apply(a,arguments)});this.$control.off("mousedown","*:not(input)");this.$control.on("mouseup","*:not(input)",function(e){let t=e.target;while(t&&t.parentNode!==a.$control[0])t=t.parentNode;e.currentTarget=t;return a.onItemSelect.apply(a,arguments)});this.$control_input.off("blur");$(document).off("mousedown"+this.eventNS);$(document).on("mousedown"+this.eventNS,function(e){if(a.isFocused){if(e.target===a.$dropdown[0]||e.target.parentNode===a.$dropdown[0])return false;if(!a.$dropdown.has(e.target).length&&e.target!==a.$control[0])a.blur(e.target)}})}}),this.clientSearch=function(){var n=function(e,t){if(typeof dropdownSelectClient==="function")if(jQuery(".selectize-dropdown-content > div").length===0)dropdownSelectClient(t(e.id),t(e.name)+(e.companyname?" ("+t(e.companyname)+")":"")+(e.id>0?" - #"+t(e.id):""),t(e.email));return'<div class="client-name"><span class="name">'+t(e.name)+(e.companyname?" ("+t(e.companyname)+")":"")+(e.id>0?" - #"+t(e.id):"")+"</span></div>"};var e=".selectize-client-search";var t=jQuery(e);var i=this;var r=[];t.each(function(){var t=$(this);var e={valueField:t.data("value-field"),allowEmptyOption:t.data("allow-empty-option")===1,labelField:"name",render:{item:n},optgroupField:"status",optgroupLabelField:"name",optgroupValueField:"id",optgroups:[{$order:1,id:"active",name:t.data("active-label")},{$order:2,id:"inactive",name:t.data("inactive-label")}],load:i.builder.onLoadEvent(t.data("search-url"),function(e){return{dropdownsearchq:e,clientId:a.currentValue,showNoneOption:t.data("allow-empty-option")===1}}),onChange:function(e){if(e&&typeof dropdownSelectClient==="function"){e=parseInt(e);var t=jQuery(".selectize-dropdown-content div[data-value|='"+e+"']");dropdownSelectClient(e,t.children("span.name").text(),t.children("span.email").text())}}};var a=i.clients(t,undefined,e);a.on("change",i.builder.onChangeEvent(a,"#goButton"));return r.push(a)});if(r.length>1)return r;return r[0]},this.userSearch=function(){var n=function(e,t){var a="",n=!isNaN(e.id);if(n&&e.id>0)a=" - #"+t(e.id);return'<div><span class="name">'+t(e.name)+a+"</span></div>"};var i=".selectize-user-search";var e=jQuery(i);var r=this;var o=[];e.each(function(){var e=$(this);var t={valueField:e.data("value-field"),labelField:"name",render:{item:n},preload:false,load:r.builder.onLoadEvent(e.data("search-url"),function(e){return{token:csrfToken,search:e}})};var a=r.users(i,undefined,t);return o.push(a)});if(o.length>1)return o;return o[0]},this.serviceSearch=function(){var n=function(e){var t=$("<div>");if(e.color)t.css("background-color",e.color);t.append($("<span>").attr("class","name").text(e.name));return t};var i=".selectize-service-search";var e=jQuery(i);var r=this;var o=[];e.each(function(){var e=$(this);var t={valueField:"id",labelField:"name",render:{item:n},preload:true,load:r.builder.onLoadEvent(e.data("search-url"),function(e){return{token:csrfToken,search:e}})};var a=r.services(i,undefined,t);return o.push(a)});if(o.length>1)return o;return o[0]},this.productSearch=function(){var a=".selectize-product-search",e=jQuery(a),n=this,i=[],r=function(e,t){var a=jQuery("<div>"),n=jQuery("<span>").attr("class","name").text(t(e.name));a.append(n);return a};e.each(function(){var e=jQuery(this),t={valueField:"id",labelField:"name",render:{item:r},optgroupField:"groupid",optgroupLabelField:"name",optgroupValueField:"id",preload:true,load:n.builder.onLoadEvent(e.data("search-url"),function(e){return{token:csrfToken,search:e}}),onLoad:function(e){var t=this,a=jQuery(".product-recommendations-wrapper li");e.forEach(function(e){if(a.find('input[value="'+e.id+'"]').length){t.removeOption(e.id);return}t.addOptionGroup(e.groupid,{$order:e.order,name:e.group})})},onBlur:function(){this.clear()},onItemAdd:function(e){var t=jQuery(".product-recommendations-wrapper li"),a=t.find('input[value="'+e+'"]').length,n=jQuery("div.recommendation-alert"),i=false;if(e&&a<1){var r=jQuery(".selectize-dropdown-content div[data-value|='"+e+"']"),o=jQuery(".product-recommendations-wrapper .clonable-item"),s=o.closest("ul"),d=o.clone().removeClass("hidden clonable-item");d.find("a span.recommendation-name").text(r.siblings("div.optgroup-header").text()+" - "+r.children("span.name").text());jQuery("<input>").attr({type:"hidden",name:"productRecommendations[]",value:e}).appendTo(d);d.find("input").val(e);d.appendTo(s);l.removeOption(e);i=true}if(t.length>0){jQuery(".product-recommendations-wrapper .placeholder-list-item").addClass("hidden");i=true}if(i&&n.not(":visible"))jQuery(".recommendation-alert").removeClass("hidden")}},l=n.products(a,undefined,t);return i.push(l)});if(i.length>1)return i;return i[0]},this.clients=function(e,t,a){var n=this.register(e,t,WHMCS.selectize.optionDecorator.client,a);n.settings.searchField=["name","email","companyname"];return n},this.users=function(e,t,a){var n=this.register(e,t,WHMCS.selectize.optionDecorator.user,a);n.settings.searchField=["name","email"];return n},this.services=function(e,t,a){var n=this.register(e,t,WHMCS.selectize.optionDecorator.service,a);n.settings.searchField=["name","noResults"];return n},this.billingContacts=function(e,t,a){var n=this.register(e,t,WHMCS.selectize.optionDecorator.billingContact,a);n.settings.searchField=["name","email","companyname","address"];return n},this.payMethods=function(e,t,a){var n=this.register(e,t,WHMCS.selectize.optionDecorator.payMethod,a);n.settings.searchField=["description","shortAccountNumber","type","payMethodType"];return n},this.products=function(e,t,a){var n=this.register(e,t,WHMCS.selectize.optionDecorator.product,a);n.settings.searchField=["id","name","noResults"];return n},this.html=function(e,t,a){var n=this.register(e,t,function(e,t){return'<div class="item">'+e.html+"</div>"},a);n.settings.searchField=["html"];return n},this.simple=function(e,t,a){var n=this.register(e,t,function(e,t){return'<div class="item">'+e.value+"</div>"},a);n.settings.searchField=["value"];return n},this.register=function(e,t,a,n){var i=this;var r=jQuery(e);var o=i.builder.init(r,n);var s=i.builder.itemDecorator(a);if(typeof n==="undefined"){o.settings.render.item=s;o.settings.render.option=s}else if(typeof n.render==="undefined"){o.settings.render.item=s;o.settings.render.option=s}else{if(typeof n.render.item==="undefined")o.settings.render.item=s;if(typeof n.render.option==="undefined")o.settings.render.option=s}this.builder.addOptions(o,t);return o},this.optionDecorator={client:function(e,t){var a=t(e.name),n="",i="",r="";if(e.companyname)n=" ("+t(e.companyname)+")";if(typeof e.descriptor==="undefined")i=e.id>0?" - #"+t(e.id):"";else i=t(e.descriptor);if(e.email)r='<span class="email">'+t(e.email)+"</span>";return"<div>"+'<span class="name">'+a+n+i+"</span>"+r+"</div>"},user:function(e,t){var a=t(e.name),n="",i="",r=!isNaN(e.id);if(typeof e.descriptor==="undefined")n=r&&e.id>0?" - #"+t(e.id):"";else n=t(e.descriptor);if(r&&e.id>0&&e.email)i='<span class="email">'+t(e.email)+"</span>";return"<div>"+'<span class="name">'+a+n+"</span>"+i+"</div>"},billingContact:function(e,t){var a=t(e.name),n="",i="",r="",o="";if(e.companyname)n=" ("+t(e.companyname)+")";if(typeof e.descriptor==="undefined")i=e.id>0?" - #"+t(e.id):"";else i=t(e.descriptor);if(e.email)r='<span class="email">'+t(e.email)+"</span>";if(e.address)o='<span class="email">'+t(e.address)+"</span>";return"<div>"+'<span class="name">'+a+n+i+"</span>"+r+o+"</div>"},payMethod:function(e,t){var a="",n="",i="",r="",o="";if(e.brandIcon)a='<i class="'+e.brandIcon+'"></i>';if(e.isDefault)i='&nbsp;&nbsp;<i class="fal fa-user-check"></i>';if(e.description)n=e.description;if(e.shortAccountNumber)if(n.indexOf(e.shortAccountNumber)===-1)r="("+t(e.shortAccountNumber)+")";if(e.detail1)o='<span class="mouse">'+t(e.detail1)+"</span>";return"<div>"+'<span class="name"> '+a+"&nbsp;"+n+"&nbsp;"+r+"&nbsp;"+"&nbsp;&nbsp;"+o+"&nbsp;&nbsp;"+i+"</span>"+"</div>"},service:function(e,t){var a="";if(e.color)a=' style="background-color: '+e.color+';"';return"<div"+a+'><span class="name">'+t(e.name)+"</span>"+(e.noResults?'<span class="email">'+t(e.noResults)+"</span>":"")+"</div>"},product:function(e,t){return'<div><span class="name">'+t(e.name)+"</span>"+(e.noResults?'<span class="email">'+t(e.noResults)+"</span>":"")+"</div>"}},this.builder={init:function(n,e){var t,a={plugins:["whmcs_no_results"],valueField:"id",labelField:"id",create:false,maxItems:1,preload:"focus"};if(typeof e==="undefined")e={};t=jQuery.extend({},a,e);var i=n.selectize(t);i=i[0].selectize;i.currentValue="";i.on("focus",function(){i.currentValue=i.getValue();i.clear()});i.on("blur",function(){var e=i.getValue(),t=!isNaN(e),a=1;if(n.data("allow-empty-option")===1)a=0;if(e===""||t&&e<a)i.setValue(i.currentValue)});return i},addOptions:function(e,t){if(typeof t!=="undefined"&&t.length)e.addOption(t)},itemDecorator:function(e){if(typeof e==="function")return e;else if(typeof e==="undefined")return WHMCS.selectize.optionDecorator.user},onLoadEvent:function(a,n){return function(e,t){jQuery.ajax({url:a,type:"POST",dataType:"json",data:n(e),error:function(){t()},success:function(e){t(e)}})}},onChangeEvent:function(a,n){var e;if(typeof n!=="undefined")e=function(e){var t=jQuery(n);if(t.length)if(!isNaN(a.currentValue)&&a.currentValue>0&&(e.length&&e!==a.currentValue))t.click()};return e}},this}),function(e){WHMCS.hasModule("payment")||WHMCS.loadModule("payment",e)}({internal:function(){this.isRenderSource=function(e){return["checkout","invoice-pay","admin-payment-method-add","admin-payment-method-edit","payment-method-add","payment-method-edit"].includes(e)},this.reportUnknownSource=function(e){return!WHMCS.payment.internal.isRenderSource(e)&&(WHMCS.payment.internal.logError("unknown source: "+e),!0)},this.logError=function(e){console.error("[WHMCS.payment] "+e)}},handler:function(){this.make=function(e){return new function(e){this.module=e,this.onGatewayInit=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onGatewayInit(this.module,e,t),this},this.onGatewayOptionInit=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onGatewayOptionInit(this.module,e,t),this},this.onGatewaySelected=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onGatewaySelected(this.module,e,t),this},this.onGatewayUnselected=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onGatewayUnselected(this.module,e,t),this},this.onCheckoutFormSubmit=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onCheckoutFormSubmit(this.module,e,t),this},this.onAddPayMethodFormSubmit=function(e,t={}){t={...WHMCS.payment.register.defaultEventOpts(),...t};return WHMCS.payment.register.onAddPayMethodFormSubmit(this.module,e,t),this},this.manageInputsContainer=function(a,e={}){e={...WHMCS.payment.register.defaultEventOpts(),priority:1,...e};return this.onGatewayInit(function(e,t){"invoice-pay"==e._source&&(WHMCS.payment.display.reset(),WHMCS.payment.display.show(jQuery(a)))},e),this.onGatewaySelected(function(e,t){"payment-method-add"==e._source&&(WHMCS.payment.display.reset(),jQuery("div.fieldgroup-creditcard,div.fieldgroup-bankaccount,div.fieldgroup-auxfields").hide()),WHMCS.payment.display.show(jQuery(a))},e),this.onGatewayUnselected(function(e,t){WHMCS.payment.display.hide(jQuery(a))},e),this}}(e)}},register:function(){this.onGatewayInit=function(e,t,a){return this.isFunction("register.gatewayInit",t)&&this.registerForEvent(WHMCS.payment.event.observersGatewayInit,e,t,a),this},this.onGatewayOptionInit=function(e,t,a){return this.isFunction("register.gatewayOptionInit",t)&&this.registerForEvent(WHMCS.payment.event.observersGatewayOptionInit,e,t,a),this},this.onGatewaySelected=function(e,t,a){return this.isFunction("register.onGatewaySelected",t)&&this.registerForEvent(WHMCS.payment.event.observersGatewaySelected,e,t,a),this},this.onGatewayUnselected=function(e,t,a){return this.isFunction("register.onGatewayUnselected",t)&&this.registerForEvent(WHMCS.payment.event.observersGatewayUnselected,e,t,a),this},this.onCheckoutFormSubmit=function(e,t,a){return this.isFunction("register.onCheckoutFormSubmit",t)&&this.registerForEvent(WHMCS.payment.event.observersCheckoutFormSubmit,e,t,a),this},this.onAddPayMethodFormSubmit=function(e,t,a){return this.isFunction("register.onAddPayMethodFormSubmit",t)&&this.registerForEvent(WHMCS.payment.event.observersAddPayMethodFormSubmit,e,t,a),this},this.defaultEventOpts=function(){return{priority:100,once:!1}},this.registerForEvent=function(e,t,a,n){return e.has(t)||e.set(t,new Map),e.get(t).set(n.priority,{_fn:a,...n}),this},this.isFunction=function(e,t){return"function"==typeof t||(console.error("[register."+e+"] Expecting a function, got "+t),!1)}},event:function(){this.observersGatewayInit=new Map,this.observersGatewayOptionInit=new Map,this.observersGatewaySelected=new Map,this.observersGatewayUnselected=new Map,this.observersCheckoutFormSubmit=new Map,this.observersAddPayMethodFormSubmit=new Map,this.previouslySelected=null,this.gatewayInit=function(e,t){this.notifyEvent("gatewayInit",this.observersGatewayInit,t,e)},this.gatewayOptionInit=function(e,t,a){this.notifyEvent("gatewayOptionInit",this.observersGatewayOptionInit,t,e,a)},this.gatewaySelected=function(e,t,a){this.previouslySelected={formElement:a,module:t},this.notifyEvent("gatewaySelected",this.observersGatewaySelected,t,e,a)},this.gatewayUnselected=function(e){null!=this.previouslySelected&&this.notifyEvent("gatewayUnselected",this.observersGatewayUnselected,this.previouslySelected.module,e,this.previouslySelected.formElement)},this.checkoutFormSubmit=function(e,t,a){this.notifyEvent("checkoutFormSubmit",this.observersCheckoutFormSubmit,t,e,a)},this.addPayMethodFormSubmit=function(e,t,a){this.notifyEvent("addPayMethodFormSubmit",this.observersAddPayMethodFormSubmit,t,e,a)},this.notifyEvent=function(e,t,a,n,i){var r,o;t.has(a)&&(r=t.get(a),o=[],this.notifyOrdered(r,function(e,t){e._fn(n,i),e.once&&o.push(t)}),o.forEach(function(e){r.delete(e)}))},this.notifyOrdered=function(e,t){new Map([...e.entries()].sort()).forEach(t)}},query:function(){this.isGatewaySelected=function(e){return null!=WHMCS.payment.event.previouslySelected&&WHMCS.payment.event.previouslySelected.module==e}},behavior:function(){this.disableDefaultCardValidation=function(e){"invoice-pay"==e?"function"==typeof validateCreditCardInput&&jQuery("#frmPayment").off("submit",validateCreditCardInput):"checkout"==e?"function"==typeof validateCheckoutCreditCardInput&&jQuery("#frmCheckout").off("submit",validateCheckoutCreditCardInput):WHMCS.payment.internal.reportUnknownSource(e)},this.enableDefaultCardValidation=function(e){"invoice-pay"==e?"function"==typeof validateCreditCardInput&&jQuery("#frmPayment").on("submit",validateCreditCardInput):"checkout"==e?"function"==typeof validateCheckoutCreditCardInput&&jQuery("#frmCheckout").on("submit",validateCheckoutCreditCardInput):WHMCS.payment.internal.reportUnknownSource(e)}},display:function(){this.reset=function(){var e=jQuery("#paymentGatewayInput");if(0!=e.length)return(e=e.children()).hide(),jQuery("body").append(e),this},this.show=function(e){var t=jQuery("#paymentGatewayInput");if(0!=t.length)return t.append(e),e.slideDown(),this},this.hide=function(e){return e.slideUp({complete:function(){jQuery("body").append(e)}}),this},this.error=function(e){return jQuery(".gateway-errors").html(e),this},this.errorClear=function(){var e=jQuery(".gateway-errors");if(0!=e.length)return this.error(""),e.slideUp(),this},this.errorShow=(e,t="invoice-pay")=>{var a=jQuery(".gateway-errors");if("checkout"===t&&"function"==typeof showCheckoutError&&showCheckoutError(e,a),"invoice-pay"===t){if(0===a.length)return this;this.error(e),a.slideDown()}return this},this.submitReset=function(e){"invoice-pay"==e?this.invoiceSubmitReset():"checkout"==e?this.checkoutSubmitReset():WHMCS.payment.internal.reportUnknownSource(e)},this.invoiceSubmitReset=function(){var e=jQuery("#btnSubmit").prop("disabled",!1).removeClass("disabled");e.find(".click-text").hide(),e.find(".pay-text").show()},this.checkoutSubmitReset=function(){jQuery("#btnCompleteOrder").removeClass("disabled").removeClass("disable-on-click").removeClass("spinner-on-click").addClass("disable-on-click spinner-on-click").prop("disabled",!1).find("i.fas").removeAttr("class").addClass("fas fa-arrow-circle-right")},this.submitDisable=function(e){"invoice-pay"==e?this.invoiceSubmitDisable():"checkout"==e?this.checkoutSubmitDisable():WHMCS.payment.internal.reportUnknownSource(e)},this.invoiceSubmitDisable=function(){jQuery("#btnSubmit").addClass("disabled").prop("disabled",!0)},this.checkoutSubmitDisable=function(){jQuery("#btnCompleteOrder").addClass("disabled").prop("disabled",!0)}}}),jQuery(document).ready(function(){function t(){addingPayment=!1,jQuery("#btnAddPayment").attr("disabled","disabled"),jQuery("#paymentText").hide(),jQuery("#paymentLoading").removeClass("hidden").show();var e=Object.fromEntries(new FormData(document.forms.namedItem("addPayment")));WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/billing/check-transaction"),{token:e.token,transaction_id:e.transid,payment_method:e.paymentmethod}).done(function(e){!1===e.unique?jQuery("#modalDuplicateTransaction").modal("show"):addInvoicePayment()})}jQuery('[data-toggle="tooltip"]').tooltip(),jQuery('[data-toggle="popover"]').popover(),jQuery(".inline-editable").editable({mode:"inline",params:function(e){return e.action="savefield",e.token=csrfToken,e}}),generateBootstrapSwitches(),jQuery("select.form-control.enhanced").select2({theme:"bootstrap"}),jQuery("body").on("click",".copy-to-clipboard",WHMCS.ui.clipboard.copy),jQuery(".credit-card-type li a").click(function(){jQuery("#selectedCard").html(jQuery(this).html()),jQuery("#cctype").val(jQuery("span.type",this).html())}),jQuery(".paging-dropdown li a,.page-selector").click(function(){var e;return jQuery(this).parent().hasClass("disabled")||(e=jQuery("#frmRecordsFound"),jQuery("#currentPage").html(jQuery(this).data("page")),e.find('input[name="page"]').val(jQuery(this).data("page")).end(),e.submit()),!1}),jQuery(".no-results a").click(function(e){e.preventDefault(),jQuery("#checkboxShowHidden").bootstrapSwitch("state",!1)}),jQuery("body").on("click","a.autoLinked",function(e){if(e.preventDefault(),jQuery(this).hasClass("disabled"))return!1;e=window.open();e.opener=null,e.location=$(this).attr("href")}),jQuery("#divModuleSettings").on("click",".icon-refresh",function(){fetchModuleSettings(jQuery(this).data("product-id"),"simple"),processAddonDisplay()}),jQuery("#mode-switch").click(function(){fetchModuleSettings(jQuery(this).data("product-id"),jQuery(this).attr("data-mode"))}),$("body").on("click",".modal-wizard .modal-submit",function(){var o=$("#modalAjax"),e=(o.find(".loader").show(),o.find(".modal-submit").prop("disabled",!0),$(".modal-wizard .wizard-step:hidden :input").attr("disabled",!0),document.forms.namedItem("frmWizardContent")),e=new FormData(e),t=$(".modal-wizard .wizard-step:visible").data("step-number"),a=$("#ccGatewayFormSubmitted").val(),n=$("#enomFormSubmitted").val(),s=new XMLHttpRequest;a&&3==t||n&&5==t?(wizardStepTransition(!1,!0),fadeoutLoaderAndAllowSubmission(o)):(s.open("POST",$("#frmWizardContent").attr("action"),!0),s.send(e),s.onload=function(){if(200==s.status)try{var e,t=JSON.parse(s.responseText),a=$("#btnWizardDoNotShow");if(a.is(":visible")&&a.fadeOut("slow",function(){$("#btnWizardSkip").hide().removeClass("hidden").fadeIn("slow")}),t.success){if(t.sslData){var n=t.sslData;if(n.approverEmails)for(i=0;i<n.approverEmails.length;i++){var r=n.approverEmails[i];$(".modal-wizard .cert-approver-emails").append('<label class="radio-inline"><input type="radio" name="approver_email" value="'+r+'"> '+r+"</label><br>")}if(n.approvalMethods)for(i=0;i<n.approvalMethods.length;i++)$("label[for='"+n.approvalMethods[i]+"Method']").removeClass("hidden").show()}else t.authData&&("emailauth"==(e=t.authData).method?($(".modal-wizard .cert-email-auth").removeClass("hidden"),$(".modal-wizard .cert-email-auth-emailapprover").val(e.email)):"fileauth"==e.method?($(".modal-wizard .cert-file-auth").removeClass("hidden"),$(".modal-wizard .cert-file-auth-filename").val("http://<domain>/"+e.path+"/"+e.name),$(".modal-wizard .cert-file-auth-contents").val(e.contents)):"dnsauth"==e.method&&($(".modal-wizard .cert-dns-auth").removeClass("hidden"),$(".modal-wizard .cert-dns-auth-contents").val(e.value),$(".modal-wizard .cert-dns-auth-host").val(e.host),$(".modal-wizard .cert-dns-auth-type").val(e.type)));t.refreshMc&&$("#btnMcServiceRefresh").click(),wizardStepTransition(t.skipNextStep,!1)}else wizardError(t.error)}catch(e){wizardError("An error occurred while communicating with the server. Please try again.")}finally{fadeoutLoaderAndAllowSubmission(o)}else alert("An error occurred while communicating with the server. Please try again."),o.find(".loader").fadeOut()})}).on("click","#btnWizardSkip",function(e){e.preventDefault();var e=$("#inputWizardStep").val(),t="2"!==e&&"4"!==e?!1:!0;trackWizardAction(e,"skipped"),wizardStepTransition(t,!0)}).on("click","#btnWizardBack",function(e){e.preventDefault(),wizardStepBackTransition()}).on("click","#btnWizardDoNotShow",function(e){e.preventDefault(),WHMCS.http.jqClient.post("wizard.php","dismiss=true",function(){$("#modalAjax").modal("hide")})}),$("#modalAjax").on("hidden.bs.modal",function(e){$("#modalAjax").hasClass("modal-wizard")&&($("#btnWizardSkip").remove(),$("#btnWizardBack").remove(),$("#btnWizardDoNotShow").remove())}),$("#prodsall").click(function(){var e=$(".checkprods");e.filter(":visible").prop("checked",$(this).prop("checked")).end(),$(this).prop("checked")&&e.filter(":hidden").prop("checked",!$(this).prop("checked")).end()}),$("#addonsall").click(function(){var e=$(".checkaddons");e.filter(":visible").prop("checked",$(this).prop("checked")).end(),$(this).prop("checked")&&e.filter(":hidden").prop("checked",!$(this).prop("checked")).end()}),$("#domainsall").click(function(){var e=$(".checkdomains");e.filter(":visible").prop("checked",$(this).prop("checked")).end(),$(this).prop("checked")&&e.filter(":hidden").prop("checked",!$(this).prop("checked")).end()}),jQuery("#addPayment").submit(function(e){e.preventDefault(),"edit"===getQueryParam("action")?handleUnsavedChanges(e,function(){t()}):t()}),$("#modalDuplicateTransaction").on("hidden.bs.modal",function(){!1===addingPayment&&jQuery("#paymentLoading").hide("fast",function(){jQuery("#paymentText").show("fast"),jQuery("#btnAddPayment").removeAttr("disabled")})}),jQuery(document).on("click",".feature-highlights-content .btn-action-1, .feature-highlights-content .btn-action-2",function(){var e=jQuery(this).data("link"),t=jQuery(this).data("link-title");WHMCS.http.jqClient.post("whatsnew.php",{action:"link-click",linkId:e,linkTitle:t,token:csrfToken})}),"undefined"!=typeof mentionsFormat&&jQuery('#replynote[name="message"],#note[name="note"]').atwho({at:"@",displayTpl:'<li class="mention-list">${gravatar} ${username} - ${name} (${email})</li>',insertTpl:mentionsFormat,data:WHMCS.adminUtils.getAdminRouteUrl("/mentions"),limit:5}),jQuery(".search-bar .search-icon").click(function(e){jQuery(".search-bar").find("input:first").focus()}),jQuery(".btn-search-advanced").click(function(e){jQuery(this).closest(".search-bar").find(".advanced-search-options").slideToggle("fast")}),WHMCS.ui.dataTable.register(),WHMCS.ui.confirmation.register(),WHMCS.ui.markdownEditor.register();var e,a=jQuery("#mcConfigureProductPromos");a.length&&(e=a.find(".item").length,a.owlCarousel({loop:!0,margin:10,responsiveClass:!0,responsive:{0:{items:1},850:{items:e<2?e:2},1250:{items:e<3?e:3},1650:{items:e<4?e:4}}}),jQuery("#dismissPromos").on("click",function(){a.slideUp("fast"),jQuery(this).hide(),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/dismiss-marketconnect-promo"),{token:csrfToken},function(e){})})),jQuery(document).on("submit","#frmCreditCardDeleteDetails",function(e){e.preventDefault(),jQuery("#modalAjax .modal-submit").prop("disabled",!0),jQuery("#modalAjax .loader").show(),$("#remoteFailureDetails").slideUp(),WHMCS.http.jqClient.post(jQuery(this).attr("action"),jQuery(this).serialize(),function(e){e.error?($("#remoteFailureDetails").find(".alert").html(e.errorMsg).end().slideDown(),jQuery("#modalAjax .loader").fadeOut()):updateAjaxModal(e)},"json").fail(function(){jQuery("#modalAjax .modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax .loader").fadeOut()})}),jQuery(".captcha-type").length&&jQuery(document).on("change",".captcha-type",function(){jQuery("#captcha-preview").attr("src",jQuery(this).find(":selected").data("image"));var e=jQuery(".recaptchasetts"),t=jQuery(".recaptchav3setts"),a=jQuery(".hcaptchasetts"),n=jQuery(this).val();["recaptcha","invisible"].includes(n)?(e.show(),t.hide(),a.hide()):["hcaptcha","hcaptcha-invisible"].includes(n)?(e.hide(),t.hide(),a.show()):"recaptchav3"===n?(a.hide(),e.show(),t.show()):(e.hide(),a.hide(),t.hide())}),jQuery("#frmClientSearch").length&&jQuery(document).on("change",".status",function(){jQuery("#status").val(jQuery(this).val())}),jQuery(".ssl-state.ssl-sync").each(function(){var t=jQuery(this);WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/domains/ssl-check"),{domain:t.data("domain"),userid:t.data("user-id"),token:csrfToken},function(e){t.replaceWith('<img src="'+e.image+'" data-toggle="tooltip" title="'+e.tooltip+'" class="'+e.class+'">'),jQuery('[data-toggle="tooltip"]').tooltip()})}),jQuery.fn.setInputError=function(e){return this.parents(".form-group").addClass("has-error").find(".field-error-msg").text(e),this},jQuery.fn.showInputError=function(){return this.parents(".form-group").addClass("has-error").find(".field-error-msg").show(),this},jQuery(".datatable .view-detail").click(function(e){e.preventDefault(),$currentRow=jQuery(this).closest("tr");var t;jQuery(this).hasClass("expanded")?($currentRow.next("tr.detail-row").hide(),jQuery(this).removeClass("expanded").find("i").removeClass("fa-minus").addClass("fa-plus")):(t=$currentRow.find("td").length,jQuery(this).hasClass("data-loaded")?$currentRow.next("tr.detail-row").show():($currentRow.after('<tr class="detail-row"><td colspan="'+t+'"><i class="fa fa-spinner fa-spin"></i> Loading...</td></tr>'),WHMCS.http.jqClient.jsonGet({url:jQuery(this).attr("href"),success:function(e){$currentRow.next("tr.detail-row").remove(),$currentRow.after('<tr class="detail-row"><td colspan="'+t+'">'+e.output+"</td></tr>")}})),jQuery(this).find("i").addClass("fa-minus").removeClass("fa-plus"),jQuery(this).addClass("expanded").addClass("data-loaded"))}),jQuery(document).on("change",".toggle-display",function(){var e=jQuery(this).data("show"),e=jQuery("."+e);jQuery(document).find("div.toggleable").hide(),e.hasClass("hidden")&&e.removeClass("hidden"),e.show()}),jQuery(document).on("click","button.disable-submit",function(e){var t=jQuery(this),a=t.closest("form");t.prepend('<i class="fas fa-spinner fa-spin"></i> ').addClass("disabled").prop("disabled",!0),a.submit()}),jQuery("#btnResendVerificationEmail").click(function(){var t=$(this);t.prop("disabled",!0).html('<i class="fa fa-spinner fa-spin fa-fw"></i> '+t.html()),WHMCS.http.jqClient.jsonPost({url:window.location.href,data:{token:csrfToken,action:"resendVerificationEmail",userid:t.data("clientid")},success:function(e){e.success?t.html(t.data("successmsg")):t.html(t.data("errormsg"))}})}),"undefined"!=typeof Selectize&&Selectize.define("whmcs_no_results",function(e){var i;this.search=(i=this.search,function(){function t(e){return isNaN(e.id)||0<e.id}var e=i.apply(this,arguments),a=e.items.filter(t),n=e.items.filter(function(e){return!t(e)});return 0<a.length?e.items=a:0<n.length&&(e.items=[n[0]]),e})}),jQuery('.addon-type[name="atype"]').on("change",function(){fetchModuleSettings(jQuery(this).closest("td").data("addon-id")),processAddonDisplay()}),jQuery(document).on("change",".module-action-control",function(){var e=$(this).data("actor"),e=jQuery('.module-action-param-row[data-action-type="'+e+'"]');parseInt($(this).val())?e.show():e.hide()}),jQuery(document).on("click",".btn-create-module-action-custom-field",function(){var t=this,e=jQuery(t).data("product-id");jQuery(t).attr("disabled","disabled"),WHMCS.http.jqClient.jsonPost({url:"configproducts.php",data:{action:"create-module-action-custom-field",id:e,token:csrfToken,field_name:jQuery(t).data("field-name"),field_type:jQuery(t).data("field-type")},success:function(e){var t=jQuery("#btnSaveProduct");jQuery(t).attr("disabled")?jQuery.growl.notice({title:"",message:e.successMsg}):jQuery(t).trigger("click")},error:function(e){jQuery(t).removeAttr("disabled"),jQuery.growl.warning({title:"",message:e})}})}),jQuery.each(jQuery("table.table-themed.data-driven"),function(){var i=$(this),e=i.DataTable();e.on("preXhr.dt",function(e,t,a){var n=document.createElement("div");jQuery(n).css({"background-color":"#fff",opacity:"0.5",position:"absolute",top:i.offset().top,left:i.offset().left,width:i.width()+2,height:i.height()+2,"line-height":i.height()+"px","font-size":"40px","text-align":"center",color:"#000","border-radius":i.css("border-radius"),zIndex:100}).attr("id",i.attr("id")+"overlay").html('<strong><i class="fas fa-spinner fa-pulse"></i></strong>'),i.before(n),a.token=csrfToken}),e.on("xhr.dt",function(e,t,a,n){jQuery("#"+i.attr("id")+"overlay").remove(),i.removeClass("text-muted")})})});var addingPayment=!1,loadedModuleConfiguration=!1,addonSupportsFeatures=!1;function updateServerGroups(e){var t="";$("#inputServerGroup").find("option:not([value=0])").each(function(){t=$(this).attr("data-server-types"),!e||!t||-1<t.indexOf(","+e+",")?$(this).attr("disabled",!1):($(this).attr("disabled",!0),$(this).is(":selected")&&$("#inputServerGroup").val("0"))})}function processAddonDisplay(){var e,t,a=jQuery('input[name="atype"]:checked');loadedModuleConfiguration?(e=jQuery("#associatedPackages"),t=jQuery("#rowProductType,#rowServerGroup"),e.find("option").prop("disabled",!1),addonSupportsFeatures&&jQuery("#addonProvisioningType").find("div.radio").each(function(){$(this).removeClass("radio-disabled").find("input").prop("disabled",!1)}),"feature"===a.val()?(e.find('option[data-server-module!="'+$("#inputModule").val()+'"]').prop("checked",!1).prop("disabled",!0),t.find("select").addClass("disabled").prop("disabled",!0)):(e.find("option").prop("disabled",!1),t.find("select").removeClass("disabled").prop("disabled",!1).find('option[value="notAvailable"]').remove()),e.bootstrapDualListbox("refresh",!0)):setTimeout(processAddonDisplay,100)}function fetchModuleSettings(e,t){var i=!1,r=$("#mode-switch"),o=$("#inputModule").val(),s=jQuery("#addonProvisioningType");if(""!==o)return loadedModuleConfiguration=!1,requestedMode=t="simple"!==(t=t||"simple")&&"advanced"!==t?"simple":t,$("#divModuleSettings").addClass("module-settings-loading"),$("#tblModuleAutomationSettings").addClass("module-settings-loading"),$("#tblMetricSettings").addClass("module-settings-loading"),$("#serverReturnedError").addClass("hidden"),$("#moduleSettingsLoader").removeClass("hidden").show(),r.attr("data-product-id",e),WHMCS.http.jqClient.post(window.location.pathname,{action:"module-settings",module:o,servergroup:$("#inputServerGroup").val(),id:e,type:$("#selectType").val(),atype:$('input[name="atype"]:checked').val(),mode:t},function(e){var t,a,n;i=!0,$("#divModuleSettings").removeClass("module-settings-loading"),$("#tblModuleAutomationSettings").removeClass("module-settings-loading"),$("#tblMetricSettings").removeClass("module-settings-loading"),$("#divModuleSettings").html(""),r.parent("div .module-settings-mode").addClass("hidden"),o&&e.error&&($("#serverReturnedErrorText").html(e.error),$("#serverReturnedError").removeClass("hidden")),o&&e.content?($("#noModuleSelectedRow").addClass("hidden"),$("#divModuleSettings").html(e.content),$("#tblModuleAutomationSettings").find("input[type=radio]").removeAttr("disabled"),"simple"===e.mode?(r.attr("data-mode","advanced").find("span").addClass("hidden").parent().find(".text-advanced").removeClass("hidden"),r.parent("div .module-settings-mode").removeClass("hidden")):"advanced"===e.mode&&"advanced"===requestedMode?(r.attr("data-mode","simple").find("span").addClass("hidden").parent().find(".text-simple").removeClass("hidden"),r.parent("div .module-settings-mode").removeClass("hidden")):r.parent("div .module-settings-mode").addClass("hidden"),e.metrics?($("#metricsConfig").html(e.metrics).show(),$("#tblMetricSettings").removeClass("hidden").show(),$(".metric-toggle").bootstrapSwitch({size:"mini",onColor:"success"}).on("switchChange.bootstrapSwitch",function(e,t){WHMCS.http.jqClient.post($(this).data("url"),"action=toggle-metric&id="+$("#inputProductId").val()+"&module="+o+"&metric="+$(this).data("metric")+"&token="+csrfToken+"&enable="+t)})):$("#tblMetricSettings").hide(),s.length&&(t=jQuery("#associatedPackages"),n=(a=jQuery("#selectType,#inputServerGroup")).find('option[value="notAvailable"]'),void 0!==e.supportsFeatures&&(addonSupportsFeatures=e.supportsFeatures,s.find("div.radio").each(function(){$(this).removeClass("radio-disabled").find("input").prop("disabled",!1)})),addonSupportsFeatures?(t.find("option").prop("disabled",!0),"feature"===jQuery('input[name="atype"]:checked').val()&&(a.addClass("disabled").prop("disabled",!0),n.length||a.prepend($("<option>").val("notAvailable").text(e.languageStrings.notAvailableForStyle).attr("selected","selected")))):(jQuery('input[name="atype"]').first().prop("checked",!0),s.find("div.radio").each(function(){$(this).addClass("radio-disabled").find("input").prop("disabled",!0)}),t.find("option").prop("disabled",!1),a.removeClass("disabled").prop("disabled",!1),n.remove()),t.bootstrapDualListbox("refresh",!0))):($("#noModuleSelectedRow").removeClass("hidden"),$("#tblModuleAutomationSettings").find("input[type=radio]").attr("disabled",!0))},"json").always(function(){$("#moduleSettingsLoader").fadeOut(),jQuery('[data-toggle="tooltip"]').tooltip(),updateServerGroups(i?o:""),loadedModuleConfiguration=!0}),"";$("#divModuleSettings").html(""),$("#noModuleSelectedRow").removeClass("hidden"),$("#tblModuleAutomationSettings").find("input[type=radio]").attr("disabled",!0),s.length&&(jQuery('input[name="atype"]').first().prop("checked",!0),s.find("div.radio").each(function(e){$(this).addClass("radio-disabled").find("input").prop("disabled",!0)}))}function wizardCall(e,t,a){e="wizard="+$('input[name="wizard"]').val()+"&step="+$('input[name="step"]').val()+"&token="+$('input[name="token"]').val()+"&action="+e+"&"+t;WHMCS.http.jqClient.post("wizard.php",e,a)}function wizardError(e){WHMCS.ui.effects.errorShake($(".modal-wizard .wizard-step:visible .info-alert:first").html(e).removeClass("hidden").addClass("alert-danger"))}function wizardStepTransition(e,t){var a=$(".modal-wizard .wizard-step:visible").data("step-number"),n=(increment=e?2:1,$(".modal-wizard .wizard-step:visible")),i=a+increment;$("#wizardStep"+i).length?(trackWizardPageView(i),$("#wizardStep"+a).fadeOut("",function(){var e="completed";t?(e="skipped",$("#wizardStepLabel"+a+" i").removeClass("fa-check-circle").addClass("fa-minus-circle")):(n.find(".signup-frm").hide(),n.find(".signup-frm-success").removeClass("hidden"),3==a?n.find(".signup-frm-success").append('<input type="hidden" id="ccGatewayFormSubmitted" name="ccGatewayFormSubmitted" value="1" />'):5==a&&n.find(".signup-frm-success").append('<input type="hidden" id="enomFormSubmitted" name="enomFormSubmitted" value="1" />')),0<i?$("#btnWizardBack").is(":visible")||$("#btnWizardBack").hide().removeClass("hidden").fadeIn("slow"):($("#btnWizardBack").fadeOut("slow"),$("#btnWizardDoNotShow").fadeIn("slow"),$("#btnWizardSkip").fadeOut("slow")),$("#wizardStepLabel"+a).removeClass("current").addClass(e),$(".modal-wizard .wizard-step:visible :input").attr("disabled",!0),$("#wizardStep"+i+" :input").removeAttr("disabled"),$("#wizardStep"+i).fadeIn(),$("#inputWizardStep").val(i),$("#wizardStepLabel"+i).addClass("current")}),$("#wizardStep"+(i+1)).length||($("#btnWizardSkip").fadeOut("slow"),$("#btnWizardBack").fadeOut("slow"),$(".modal-submit").html("Finish"))):$("#modalAjax").modal("hide")}function wizardStepBackTransition(){var e=$(".modal-wizard .wizard-step:visible").data("step-number"),t=parseInt(e)-1;$("#wizardStep"+e).fadeOut("",function(){trackWizardPageView(t),t<1&&($("#btnWizardBack").fadeOut("slow"),$("#btnWizardDoNotShow").fadeIn("slow"),$("#btnWizardSkip").addClass("hidden")),$(".modal-wizard .wizard-step:visible :input").attr("disabled",!0),$("#wizardStep"+t+" :input").removeAttr("disabled"),$("#wizardStep"+t).fadeIn(),$("#inputWizardStep").val(t),$("#wizardStepLabel"+t).addClass("current"),$("#wizardStepLabel"+e).removeClass("current")})}function fadeoutLoaderAndAllowSubmission(e){e.find(".loader").fadeOut(),e.find(".modal-submit").removeProp("disabled")}function addInvoicePayment(){addingPayment=!0,jQuery("#modalDuplicateTransaction").modal("hide"),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/billing/invoice/"+thisInvoiceId+"/add-payment"),jQuery("#addPayment").serialize()).done(function(e){e.redirectUri&&(window.location=e.redirectUri)})}function cancelAddPayment(){jQuery("#paymentLoading").fadeOut("fast",function(){jQuery("#paymentText").fadeIn("fast"),jQuery("#btnAddPayment").removeAttr("disabled")}),jQuery("#modalDuplicateTransaction").modal("hide")}function openFeatureHighlights(){openModal("whatsnew.php?modal=1","","What's new in Version ...","","modal-feature-highlights","","","",!0)}function autoSubmitFormByContainer(e){"undefined"!=typeof noAutoSubmit&&!1!==noAutoSubmit||jQuery("#"+e).find("form:first").submit()}function slugify(e){for(var t="/_,:;",a=0,n=t.length;a<n;a++)e=e.replace(new RegExp(t.charAt(a),"g"),"aaaaaaaaaaacccdeeeeeeeeeiiiiiilnnooooooooooossuuuuuuyzzz-------".charAt(a));return e.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/&/g,"-and-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-")}function generateBootstrapSwitches(){jQuery(".slide-toggle").bootstrapSwitch(),jQuery(".slide-toggle-mini").bootstrapSwitch({size:"mini"})}function submitForm(e,t){e=jQuery("#"+e);t?e.attr("target","_blank"):e.removeAttr("target"),e.submit()}function reverseCommissionConfirm(e,t){var a,n=jQuery("form#transactions"),i=n.serializeArray();if((a=i.find(function(e){return"amount"===e.name}).value)||(i=i.find(function(e){return"transid"===e.name}).value,a=jQuery('form#transactions select#transid option[value="'+i+'"]').data("amount")),t+a<e)return jQuery("#modalReverseAffiliateCommission").modal().show(),!1;jQuery("<input>",{type:"hidden",name:"reverseCommission",value:"true"}).appendTo(n),n.removeAttr("onsubmit").submit()}function reverseCommissionSubmit(e=!1){var t=jQuery("form#transactions");e&&jQuery("<input>",{type:"hidden",name:"reverseCommission",value:"true"}).appendTo(t),t.removeAttr("onsubmit").submit()}function autosizeTextarea(e){function t(){this.style.height="auto",this.style.height=a(this)}for(var a=function(e){return e.scrollHeight+parseFloat(jQuery(e).css("borderTopWidth"))+parseFloat(jQuery(e).css("borderBottomWidth"))+"px"},n=document.querySelectorAll(e),i=0;i<n.length;i++)n[i].style.overflowX="hidden",n[i].style.height=a(n[i]),n[i].addEventListener("input",t)}function calculateInvoiceTotal(e,t){return WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/invoice-total/calculate"),{invoiceId:e,items:t,token:csrfToken})}function destroyInvoiceItem(e){return WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/invoice-item/destroy"),{invoiceItemId:e,token:csrfToken})}function getQueryParam(e){return new URLSearchParams(window.location.search).get(e)}function getWizardStepPageData(e){return{1:{title:"General",path:"/getting-started"},2:{title:"Payments",path:"/getting-started/payments/step1"},3:{title:"Domain",path:"/getting-started/domains/step1"},4:{title:"eNom",path:"/getting-started/enom"},5:{title:"Web Hosting",path:"/getting-started/hosting"},6:{title:"Add-ons & Extras",path:"/getting-started/marketConnect/step1"},7:{title:"Complete",path:"/getting-started/complete"}}[e]||{title:"Unknown step",path:"/getting-started/unknown"}}function isMixpanelEnabled(){return"undefined"!=typeof mixpanel_enabled&&!0===mixpanel_enabled}function trackWizardPageView(e,t="view"){var a;isMixpanelEnabled()&&(e=getWizardStepPageData(e),a=this.getFullUrl(e.path),mixpanel.track_pageview({page:e.title+` (${t})`,$current_url:a,$referrer:a}))}function trackWizardAction(e,t){var a;isMixpanelEnabled()&&(e=getWizardStepPageData(e),a=this.getFullUrl(e.path),mixpanel.track(e.title+` (${t})`,{$current_url:a}))}function getFullUrl(e){return new URL(e,window.location.origin).toString()}var grid,packery,ajaxModalSubmitEvents=[],ajaxModalPostSubmitEvents=[];function openModal(e,t,a,n,i,r,o,s,d,l){jQuery("#modalAjax .modal-title").html(a),n&&jQuery("#modalAjax").children('div[class="modal-dialog"]').addClass(n),i&&jQuery("#modalAjax").addClass(i),r?(jQuery("#modalAjax .modal-submit").show().html(r),o&&jQuery("#modalAjax .modal-submit").attr("id",o)):jQuery("#modalAjax .modal-submit").hide(),d&&jQuery("#modalAjaxClose").hide(),s&&jQuery("#modalAjax .modal-submit").removeClass("btn-primary").addClass("btn-"+s),jQuery("#modalAjax .modal-body").html(""),jQuery("#modalSkip").hide(),disableSubmit(),jQuery("#modalAjax").modal({show:!0,keyboard:!0,backdrop:!jQuery("#modalAjax").hasClass("static")||"static"}),WHMCS.http.jqClient.post(e,t,function(e){updateAjaxModal(e)},"json").fail(function(){jQuery("#modalAjax .modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax .loader").fadeOut()}).always(function(){var e=jQuery("#modalAjax").find("form"),e=(o&&e.submit(function(e){return submitIdAjaxModalClickEvent(),!1}),l&&e.data("successDataTable",l),jQuery(e).find("input:not(input[type=checkbox],input[type=radio],input[type=hidden])"));0<e.length&&jQuery(e).first().focus()}),o&&((a=jQuery("#"+o)).off("click"),a.on("click",submitIdAjaxModalClickEvent))}function submitIdAjaxModalClickEvent(){var n,a,i,r=!0,e=jQuery("#modalAjax .loader");disableSubmit(),e.show(),ajaxModalSubmitEvents.length&&jQuery.each(ajaxModalSubmitEvents,function(e,t){t=window[t];r&&"function"==typeof t&&(r=t())}),r?(n=jQuery("#modalAjax").find("form"),a=jQuery("#modalAjax .modal-body"),i=jQuery(a).find(".admin-modal-error"),jQuery(i).slideUp(),WHMCS.http.jqClient.post(n.attr("action"),n.serialize(),function(a){n.data("successDataTable")&&(a.successDataTable=n.data("successDataTable")),ajaxModalPostSubmitEvents.length&&jQuery.each(ajaxModalPostSubmitEvents,function(e,t){t=window[t];"function"==typeof t&&t(a,n)}),updateAjaxModal(a)},"json").fail(function(e){var e=e.responseJSON,t="An error occurred while communicating with the server. Please try again.";e&&e.data?(e=e.data).errorMsg?0<i.length?jQuery(i).html(e.errorMsg).slideDown():jQuery.growl.warning({title:e.errorMsgTitle,message:e.errorMsg}):e.data.body?jQuery(a).html(e.body):jQuery(a).html(t):jQuery(a).html(t),jQuery("#modalAjax .loader").fadeOut(),enableSubmit()})):(enableSubmit(),e.hide())}function updateAjaxModal(e){var t;e.reloadPage?"string"==typeof e.reloadPage?window.location=e.reloadPage:window.location.reload():(e.successDataTable&&WHMCS.ui.dataTable.getTableById(e.successDataTable,void 0).ajax.reload(),e.redirect&&(window.location=e.redirect),e.successWindow&&"function"==typeof window[e.successWindow]&&window[e.successWindow](),e.dismiss&&dialogClose(),e.successMsg&&jQuery.growl.notice({title:e.successMsgTitle,message:e.successMsg}),e.errorMsg&&(0<(t=jQuery("#modalAjax .modal-body .admin-modal-error")).length&&!e.dismiss?jQuery(t).html(e.errorMsg).slideDown():jQuery.growl.warning({title:e.errorMsgTitle,message:e.errorMsg})),e.title&&jQuery("#modalAjax .modal-title").html(e.title),e.body?jQuery("#modalAjax .modal-body").html(e.body):e.url&&WHMCS.http.jqClient.post(e.url,"",function(e){jQuery("#modalAjax").find(".modal-body").html(e.body)},"json").fail(function(){jQuery("#modalAjax").find(".modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax").find(".loader").fadeOut()}),e.submitlabel&&(jQuery("#modalAjax .modal-submit").html(e.submitlabel).show(),e.submitId)&&jQuery("#modalAjax").find(".modal-submit").attr("id",e.submitId),e.submitId&&((t=jQuery("#"+e.submitId)).off("click"),t.on("click",submitIdAjaxModalClickEvent)),(e.disableSubmit?disableSubmit:enableSubmit)(),t=!0,dismissLoaderAfterRender(t=void 0!==e.dismissLoader?e.dismissLoader:t),e.hideSubmit&&ajaxModalHideSubmit())}function dialogSubmit(){disableSubmit(),jQuery("#modalAjax .loader").show();var e=jQuery("#modalAjax").find("form").attr("action");WHMCS.http.jqClient.post(e,jQuery("#modalAjax").find("form").serialize(),function(e){updateAjaxModal(e)},"json").fail(function(){jQuery("#modalAjax .modal-body").html("An error occurred while communicating with the server. Please try again."),jQuery("#modalAjax .loader").fadeOut()})}function dialogClose(){jQuery("#modalAjax").modal("hide")}function addAjaxModalSubmitEvents(e){e&&ajaxModalSubmitEvents.push(e)}function removeAjaxModalSubmitEvents(e){e&&0<=(e=ajaxModalSubmitEvents.indexOf(e))&&ajaxModalSubmitEvents.splice(e,1)}function addAjaxModalPostSubmitEvents(e){e&&ajaxModalPostSubmitEvents.push(e)}function removeAjaxModalPostSubmitEvents(e){e&&0<=(e=ajaxModalPostSubmitEvents.indexOf(e))&&ajaxModalPostSubmitEvents.splice(e,1)}function disableSubmit(){jQuery("#modalAjax .modal-submit").prop("disabled",!0).addClass("disabled")}function enableSubmit(){jQuery("#modalAjax .modal-submit").prop("disabled",!1).removeClass("disabled")}function ajaxModalHideSubmit(){jQuery("#modalAjax .modal-submit").hide()}function dismissLoaderAfterRender(e){!1===e?jQuery("#modalAjax .loader").show():jQuery("#modalAjax .loader").fadeOut()}function refreshWidget(e,t){var a=$('.panel[data-widget="'+e+'"]'),n=a.find(".panel-body"),i=a.find("i.fa-sync");n.addClass("panel-loading"),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/refresh&widget="+e+"&"+t),{token:csrfToken},function(e){n.html(e.widgetOutput),n.removeClass("panel-loading")},"json").always(function(){i.removeClass("fa-spin")})}function loadAutomationStatsForDate(e){$("#statsContainer").css("opacity","0.5"),WHMCS.http.jqClient.post("automationstatus.php","action=stats&date="+e,function(e){$(".widgets-container").html(e.body),$(".day-selector").find(".btn-viewing").html(e.newDate)}).fail(function(){jQuery.growl({title:"",message:"Your session has expired. Please refresh to continue."})}).always(function(){$("#statsContainer").css("opacity","1")})}function refreshGraph(){$("#graphContainer").css("opacity","0.5");WHMCS.http.jqClient.post("automationstatus.php","action=graph&metric="+$(".graph-filter-metric a.active").attr("href")+"&period="+$(".graph-filter-period a.active").attr("href"),function(e){$("#graphContainer").html(e.body)}).fail(function(){jQuery.growl({title:"",message:"Your session has expired. Please refresh to continue."})}).always(function(){$("#graphContainer").css("opacity","1")})}function initDateRangePicker(){jQuery(document).ready(function(){jQuery(".date-picker-search").each(function(e){var t=jQuery(this),a=t.data("opens"),n=t.data("drops"),i=adminJsVars.dateRangePicker.defaultRanges,r=adminJsVars.dateRangeFormat;a&&void 0!==a||(a="center"),n&&void 0!==n||(n="down"),t.hasClass("future")&&(i=adminJsVars.dateRangePicker.futureRanges),t.daterangepicker({autoUpdateInput:!1,ranges:i,alwaysShowCalendars:!0,opens:a,drops:n,showDropdowns:!0,minYear:adminJsVars.minYear,maxYear:adminJsVars.maxYear,locale:{format:r,applyLabel:adminJsVars.dateRangePicker.applyLabel,cancelLabel:adminJsVars.dateRangePicker.cancelLabel,customRangeLabel:adminJsVars.dateRangePicker.customRangeLabel,monthNames:adminJsVars.dateRangePicker.months,daysOfWeek:adminJsVars.dateRangePicker.daysOfWeek}}).on("show.daterangepicker",function(e,t){""!=t.element[0].id&&(t.container[0].id="dateRangePicker_"+t.element[0].id)}).on("apply.daterangepicker",function(e,t){jQuery(this).val(t.startDate.format(adminJsVars.dateRangeFormat)+" - "+t.endDate.format(adminJsVars.dateRangeFormat))}).on("cancel.daterangepicker",function(e,t){jQuery(this).val("")})}),jQuery(".datepick,.date-picker,.date-picker-single").each(function(e){var t=jQuery(this),a=t.data("opens"),n=t.data("drops"),i=adminJsVars.dateRangePicker.defaultSingleRanges,r=adminJsVars.dateRangeFormat,o=!1;a&&void 0!==a||(a="center"),n&&void 0!==n||(n="down"),t.hasClass("future")&&(i=adminJsVars.dateRangePicker.futureSingleRanges),t.hasClass("time")&&(o=!0,r=adminJsVars.dateTimeRangeFormat,t.hasClass("future"))&&(i=adminJsVars.dateRangePicker.futureTimeSingleRanges),t.daterangepicker({singleDatePicker:!0,autoUpdateInput:!1,ranges:i,alwaysShowCalendars:!0,opens:a,drops:n,showDropdowns:!0,minYear:adminJsVars.minYear,maxYear:adminJsVars.maxYear,timePicker:o,timePickerSeconds:!1,locale:{format:r,customRangeLabel:adminJsVars.dateRangePicker.customRangeLabel,monthNames:adminJsVars.dateRangePicker.months,daysOfWeek:adminJsVars.dateRangePicker.daysOfWeek}}).on("show.daterangepicker",function(e,t){""!=t.element[0].id&&(t.container[0].id="dateRangePicker_"+t.element[0].id)}).on("apply.daterangepicker",function(e,t){jQuery(this).data("original-value",t.startDate.format(r)).val(t.startDate.format(r))}).on("cancel.daterangepicker",function(e,t){jQuery(this).val(jQuery(this).data("original-value"))})})})}jQuery(document).ready(function(){jQuery(document).on("click",".open-modal",function(e){e.preventDefault();var e=jQuery(this).attr("href"),t=jQuery(this).data("modal-size"),a=jQuery(this).data("modal-class"),n=jQuery(this).data("modal-title"),i=jQuery(this).data("btn-submit-id"),r=jQuery(this).data("btn-submit-label"),o=jQuery(this).data("btn-submit-color"),s=jQuery(this).data("btn-close-hide"),d=jQuery(this).attr("disabled"),l=jQuery(this).data("datatable-reload-success"),u="";csrfToken&&(u={token:csrfToken}),d||openModal(e,u,n,t,a,r,i,o,s,l)}),jQuery("#modalAjax").on("hidden.bs.modal",function(e){var t;jQuery(this).hasClass("modal-feature-highlights")&&(t=jQuery("#cbFeatureHighlightsDismissForVersion").is(":checked"),WHMCS.http.jqClient.post("whatsnew.php",{dismiss:"1",until_next_update:t?"1":"0",token:csrfToken})),jQuery("#modalAjax").find(".modal-body").empty(),jQuery("#modalAjax").children("div.modal-dialog").removeClass("modal-lg"),jQuery("#modalAjax").removeClass().addClass("modal whmcs-modal fade"),jQuery("#modalAjax .modal-title").html("Title"),jQuery("#modalAjax .modal-submit").html("Submit").removeClass().addClass("btn btn-primary modal-submit").removeAttr("id").removeAttr("disabled"),jQuery("#modalAjax .loader").show()})}),jQuery(document).ready(function(){var e=jQuery(".selectize-multi-select"),t=jQuery(".selectize-select"),a=jQuery(".selectize-promo"),n=jQuery(".selectize-tags"),i=jQuery(".selectize-newTicketCc,.selectize-ticketCc");jQuery(e).selectize({plugins:["remove_button"],valueField:jQuery(e).attr("data-value-field"),labelField:"name",searchField:"name",allowEmptyOption:!0,create:!1,maxItems:null,render:{item:function(e,t){return'<div><span class="name">'+t(e.name)+"</span></div>"},option:function(e,t){return'<div><span class="name">'+t(e.name)+"</span></div>"}},onItemRemove:function(e){"multi-view"==jQuery(this)[0].$input[0].id&&"any"!=e&&"flagged"!=e&&jQuery(this)[0].removeItem("any",!0)}}),jQuery(t).selectize({valueField:jQuery(t).attr("data-value-field"),labelField:"name",searchField:"name",allowEmptyOption:jQuery(t).attr("data-allow-empty-option"),create:!1,maxItems:1,render:{item:function(e,t){var a="";return"<div"+(a=void 0!==e.colour&&"#FFF"!==e.colour?' style="background-color: '+t(e.colour)+';"':a)+'><span class="name">'+t(e.name)+"</span></div>"},option:function(e,t){var a="";return"<div"+(a=void 0!==e.colour&&"#FFF"!==e.colour?' style="background-color: '+t(e.colour)+';"':a)+'><span class="name">'+t(e.name)+"</span></div>"}},onInitialize:function(){this.currentValue=""},onFocus:function(){this.currentValue=this.getValue(),this.clear()},onChange:function(){""!==this.getValue()&&this.currentValue!==this.getValue()&&(this.currentValue=this.getValue(),jQuery(t).hasClass("selectize-auto-submit"))&&jQuery(t).parent("form").submit()},onBlur:function(){this.setValue(this.currentValue)}}),jQuery(a).selectize({valueField:jQuery(a).attr("data-value-field"),labelField:"name",searchField:"name",allowEmptyOption:jQuery(a).attr("data-allow-empty-option"),create:!1,maxItems:1,render:{item:function(e,t){var a="",n=e.name.split(" - ");return void 0!==e.colour&&"#FFF"!==e.colour&&""!==e.colour&&(a=' style="background-color: '+t(e.colour)+';"'),"undefined"!=typeof otherPromos&&e.optgroup===otherPromos&&""!==this.currentValue?jQuery("#nonApplicablePromoWarning").show():jQuery("#nonApplicablePromoWarning").hide(),n[1]?"<div"+a+"><strong>"+t(n[0])+'</strong><small style="overflow: hidden"> - '+t(n[1])+"</small></div>":"<div"+a+">"+t(n[0])+"</div>"},option:function(e,t){var a="",n=e.name.split(" - ");return void 0!==e.colour&&"#FFF"!==e.colour&&""!==e.colour&&(a=' style="background-color: '+t(e.colour)+';"'),n[1]?"<div"+a+"><strong>"+t(n[0])+"</strong><br />"+t(n[1])+"</div>":"<div"+a+">"+t(n[0])+"</div>"}},onInitialize:function(){this.currentValue=""},onFocus:function(){this.$control.parent("div").css("overflow","visible"),this.currentValue=this.getValue(),this.clear()},onChange:function(){""!==this.getValue()&&this.currentValue!==this.getValue()&&(this.currentValue=this.getValue(),jQuery(a).hasClass("selectize-auto-submit"))&&jQuery(a).parent("form").submit()},onBlur:function(){this.$control.parent("div").css("overflow","hidden"),this.setValue(this.currentValue)}}),jQuery(n).selectize({plugins:["remove_button"],valueField:"text",searchField:["text"],delimiter:",",persist:!1,create:function(e){return{value:e,text:e}},render:{item:function(e,t){return'<div><span class="item">'+t(e.text)+"</span></div>"},option:function(e,t){return'<div><span class="item">'+t(e.text)+"</span></div>"}},load:function(e,t){if(!e.length)return t();jQuery.ajax({url:window.location.href,type:"POST",dataType:"json",data:{action:"gettags",q:e,token:csrfToken},error:function(){t()},success:function(e){t(e)}})},onItemAdd:function(e){jQuery.ajax({url:window.location.href,type:"POST",data:{action:"addTag",newTag:e,token:csrfToken}}).success(function(){jQuery.growl.notice({title:"",message:"Saved successfully!"})})},onItemRemove:function(e){jQuery.ajax({url:window.location.href,type:"POST",data:{action:"removeTag",removeTag:e,token:csrfToken}}).success(function(){jQuery.growl.notice({title:"",message:"Saved successfully!"})})}}),jQuery(i).selectize({plugins:["remove_button"],valueField:"text",searchField:["text"],delimiter:",",persist:!0,create:function(e){return{value:e=e.toLowerCase(),text:e,name:e,iconclass:""}},render:{item:function(e,t){return'<div class="selectize"><span class="name">'+(void 0!==e.iconclass&&0<e.iconclass.length?'<span style="padding-right: 8px"><i class="'+t(e.iconclass)+'"></i></span>'+t(e.name):t(e.name))+"</span></div>"},option:function(e,t){return'<div class="selectize"><span class="name">'+(void 0!==e.iconclass&&0<e.iconclass.length?'<span style="padding-right: 8px"><i class="'+t(e.iconclass)+'"></i></span>'+t(e.name):t(e.name))+'</span><span class="email">'+t(e.text)+"</span></div>"}}})}),$(document).ready(function(){var n=null,i=(n=(n="undefined"!=typeof Storage?JSON.parse(localStorage.getItem("minimisedWidgets")):n)||[],$(".widget-minimise").click(function(e){e.preventDefault();var e=$(this),t=e.find("i"),a=e.closest(".panel").data("widget");t.hasClass("fa-chevron-up")?(e.closest(".panel").find(".panel-body").slideUp("fast",function(){t.removeClass("fa-chevron-up").addClass("fa-chevron-down"),packery.shiftLayout()}),-1==n.indexOf(a)&&n.push(a)):(e.closest(".panel").find(".panel-body").slideDown("fast",function(e){t.removeClass("fa-chevron-down").addClass("fa-chevron-up"),packery.fit(this),packery.shiftLayout()}),n.splice(n.indexOf(a),1)),"undefined"!=typeof Storage&&localStorage.setItem("minimisedWidgets",JSON.stringify(n))}),$(".widget-refresh").click(function(e){e.preventDefault();var e=$(this),t=e.find("i"),a=e.closest(".panel").data("widget");e.closest(".panel").find(".panel-body");t.addClass("fa-spin"),refreshWidget(a,"refresh=1")}),!1);if($(".widget-hide").click(function(e){e.preventDefault();var t=$(this).closest(".panel").data("widget");i=!0,$("#panel"+t).slideUp("fast",function(){$(this).addClass("hidden"),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/display/toggle/"+t)).always(function(){$('input[data-widget="'+t+'"]').iCheck("uncheck"),i=!1}),$(".home-widgets-container").masonry().masonry("reloadItems")})}),$(document).on("ifToggled",".display-widget",function(e){var t=$(this),a=$(this).data("widget"),n=$("#panel"+a);i||(t.iCheck("disable"),t.prop("checked")?n.hasClass("hidden")&&(t.parent("div").parent("label").parent("li").addClass("active"),n.hide().removeClass("hidden").slideDown("fast",function(){WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/display/toggle/"+a)).always(function(){$(".home-widgets-container").masonry().masonry("reloadItems"),n.find(".widget-refresh").click(),!1===$("#widgetSettingsDropdown").hasClass("open")&&$("#widgetSettings").dropdown("toggle"),t.iCheck("enable")})})):!1===n.hasClass("hidden")&&(t.parent("div").parent("label").parent("li").removeClass("active"),n.slideUp("fast",function(){$(this).addClass("hidden"),$(".home-widgets-container").masonry().masonry("reloadItems"),WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/display/toggle/"+a),function(){!1===$("#widgetSettingsDropdown").hasClass("open")&&$("#widgetSettings").dropdown("toggle")},"json").always(function(){t.iCheck("enable")})})))}),$("input.display-widget").each(function(){var e=$(this),t=e.next();t.text();t.remove(),e.iCheck({inheritID:!0,checkboxClass:"icheckbox_flat-blue",increaseArea:"20%"})}),$(".home-widgets-container").length){n.forEach(function(e){$("#panel"+e).find(".panel-body").hide().end().find("i.fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down")}),Packery.prototype.getPositions=function(){return this.items.map(function(e){return e.element.getAttribute("data-widget")})},grid=document.querySelector(".home-widgets-container"),(packery=new Packery(grid,{itemSelector:".dashboard-panel-item",columnWidth:".dashboard-panel-sizer",percentPosition:!0})).stamp(document.querySelector(".dashboard-panel-static-item"));for(var e=grid.querySelectorAll(".dashboard-panel-item"),t=0;t<e.length;t++){var a=e[t],a=new Draggabilly(a,{handle:".panel-title"});packery.bindDraggabillyEvents(a)}packery.on("removeComplete",function(){packery.shiftLayout()});var r=!1;packery.on("dragItemPositioned",function(e){packery.shiftLayout(),$(".home-widgets-container").children("div.dashboard-panel-item").hasClass("is-dragging")||r||(r=!0,setTimeout(function(){WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/widget/order"),{token:csrfToken,order:packery.getPositions()},function(e){},"json").always(function(){r=!1,packery.shiftLayout()})},1e3))})}function o(){var e=jQuery(this),t=e.closest(".item");return t.hasClass("active")?e.outerHeight():(t.addClass("active"),e=e.outerHeight(),t.removeClass("active"),e)}jQuery(".admin-dashboard-carousel button.close").on("click",function(){var e=jQuery(this).closest(".alert").data("identifier"),t=jQuery(".admin-dashboard-carousel");t.find(".item").length<=1?t.remove():function(e,n){let i=e.find(".item"),t=e.find(".carousel-indicators li"),r=0;if(i.removeClass("active"),i.each(function(t,a){if(0<jQuery(a).find('[data-identifier="'+n+'"]').length){let e=parseInt(t)+1;e>=i.length&&(e=0),r=e,jQuery(a).remove(),jQuery(i[e]).addClass("active")}}),i.length<=2)return jQuery(".admin-dashboard-carousel-controls").remove();0!==r&&r--;t.removeClass("active"),t.each(function(e,t){e===r&&jQuery(t).addClass("active")}),t.last().remove()}(t,e);WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/promotions/dismiss/"+e),{token:csrfToken})}),jQuery(window).on("load resize orientationchange",function(){var e=jQuery(".admin-dashboard-carousel .promotion-content"),t=(e.css("min-height",0),Math.max.apply(null,e.map(o).get()));e.css("min-height",t+"px")})}),jQuery(document).ready(function(){let e=jQuery("#mixpanelOptInModal");var t=jQuery(".whmcs-modal.modal-setup-wizard.in"),a=document.querySelector("[data-user-id]"),a=a?a.getAttribute("data-user-id"):null;if(a&&-1===document.cookie.indexOf(`trackingOptInDismissed_${a}=true;`)&&!t.length){e.addClass("mixpanel-shown");const i=new MutationObserver(()=>{jQuery(".whmcs-modal.modal-setup-wizard.in").length&&(n(!1),i.disconnect())}),r=(i.observe(document.body,{childList:!0,subtree:!0}),jQuery("#optInAccept").on("click",function(){WHMCS.http.jqClient.post(WHMCS.adminUtils.getAdminRouteUrl("/mixpanel/config/set"),{token:csrfToken,MixPanelTrackingEnabled:!0}),n(!1),jQuery("#optInAccept").hide(),i.disconnect()}),jQuery("#optInDismiss").on("click",function(){n(!0),jQuery("#optInDismiss").hide(),i.disconnect()}),jQuery("#optInClose").on("click",function(){n(!1),i.disconnect()}),document.querySelector("input[name='mixpaneltrackingenabled']"));a=document.querySelector('input[type="submit"].btn.btn-primary');if(r&&a){let e=r.checked;a.addEventListener("click",function(){e&&!r.checked&&n(!1)})}}function n(t){e.removeClass("mixpanel-shown");var a=window.location.pathname.split("/")[1]||"",n=document.querySelector("input.adminUserId")||document.getElementById("mixpanelOptInModal"),n=n&&n.hasAttribute("data-user-id")?n.getAttribute("data-user-id"):null;if(n){let e=`trackingOptInDismissed_${n}=true; path=/${a}; SameSite=Lax`;"https:"===window.location.protocol&&(e+="; Secure"),t&&(e+="; max-age=31536000"),document.cookie=e}}}),$(document).ready(function(){$("#statsContainer").on("click",".btn-viewing",function(e){e.preventDefault()}),$("#graphContainer").on("click",".graph-filter-metric a",function(e){e.preventDefault(),$(".graph-filter-metric a").removeClass("active"),$(this).addClass("active"),refreshGraph()}),$("#graphContainer").on("click",".graph-filter-period a",function(e){e.preventDefault(),$(".graph-filter-period a").removeClass("active"),$(this).addClass("active"),refreshGraph()})}),jQuery(document).ready(function(){var e=jQuery(".database-backups");e.find(".activate").on("click",function(){var t=jQuery(this),a=t.parent("form"),n=t.data("type"),e=a.serialize();t.prop("disabled",!0).addClass("disabled"),e+="&action=save&activate=1&type="+n+"&token="+csrfToken,WHMCS.http.jqClient.post(window.location.href,e,function(e){!0===e.success?(jQuery.growl.notice({title:e.successMessageTitle,message:e.successMessage}),a.find(".save, .deactivate-start").removeClass("hidden"),t.addClass("hidden"),jQuery("#"+n+"Label").toggleClass("label-default label-success").text(e.activeText)):jQuery.growl.error({title:e.errorMessageTitle,message:e.errorMessage})},"json").always(function(){t.prop("disabled",!1).removeClass("disabled")})}),e.find(".save").on("click",function(){var e=jQuery(this),t=e.parent("form"),a=e.data("type"),t=t.serialize();e.prop("disabled",!0).addClass("disabled"),t+="&action=save&type="+a+"&token="+csrfToken,WHMCS.http.jqClient.post(window.location.href,t,function(e){!0===e.success?jQuery.growl.notice({title:e.successMessageTitle,message:e.successMessage}):jQuery.growl.error({title:e.errorMessageTitle,message:e.errorMessage})},"json").always(function(){e.prop("disabled",!1).removeClass("disabled")})}),e.find(".test").on("click",function(){var e=jQuery(this),t=e.parent("form"),a=e.data("type"),n=t.serialize();e.prop("disabled",!0).addClass("disabled"),jQuery("#"+a+"Container").removeClass("hidden"),n+="&action=test&type="+a+"&token="+csrfToken,jQuery("#"+a+"Test").hide().removeClass("hidden alert-success alert-danger").addClass("alert-default").find(".extra-text").addClass("hidden").text("").end().find(".default-text").removeClass("hidden").end().slideDown("fast"),WHMCS.http.jqClient.post(window.location.href,n,function(e){!0===e.success?(jQuery("#"+a+"Test").addClass("alert-success").removeClass("alert-default alert-danger").find(".default-text").addClass("hidden").end().find(".extra-text").text(e.successMessage).removeClass("hidden").end().delay(3e3).slideUp("slow"),t.find(".activate").prop("disabled",!1).removeClass("disabled")):jQuery("#"+a+"Test").addClass("alert-danger").removeClass("alert-default alert-success").find(".default-text").addClass("hidden").end().find(".extra-text").text(e.errorMessageTitle+": "+e.errorMessage).removeClass("hidden").end().delay(3e3).slideUp("slow")},"json").always(function(){e.prop("disabled",!1).removeClass("disabled"),jQuery("#"+a+"Container").addClass("hidden")})}),e.find(".deactivate-start").on("click",function(){var e=jQuery(this),e=(e.parent("form"),e.data("type")),t=jQuery("#modalConfirmDeactivate");jQuery("#confirmDeactivateYes").data("type",e),t.modal("show")}),jQuery("#modalConfirmDeactivate").find(".deactivate").on("click",function(){var e=jQuery(this),t=jQuery("#modalConfirmDeactivate"),a=(t.parent("form"),e.data("type")),n="action=deactivate&type="+a+"&token="+csrfToken,i=jQuery('.deactivate-start[data-type="'+a+'"]').parent("form");e.prop("disabled",!0).addClass("disabled"),WHMCS.http.jqClient.post(window.location.href,n,function(e){!0===e.success?(jQuery.growl.notice({title:e.successMessageTitle,message:e.successMessage}),i.find(".save, .deactivate-start").addClass("hidden"),i.find(".activate").removeClass("hidden").prop("disabled",!0),"email"===a&&i.find(".activate").prop("disabled",!1),jQuery("#"+a+"Label").toggleClass("label-default label-success").text(e.inactiveText)):jQuery.growl.error({title:e.errorMessageTitle,message:e.errorMessage})},"json").always(function(){e.prop("disabled",!1).removeClass("disabled"),t.modal("hide")})}),e.find("#inputDestination").on("change",function(){var e=jQuery("#destinationData"),t=jQuery(this).val();"homedir"!==t&&e.hasClass("hidden")?e.hide().removeClass("hidden").slideDown("fast"):"homedir"!==t||e.hasClass("hidden")||e.slideUp("fast").addClass("hidden")})}),initDateRangePicker(),jQuery(document).ready(function(){var i,r,o,t=jQuery("button.retry-all");function a(){if(i){var e=jQuery("button.retry:eq("+o+")");if(!e.length)return clearTimeout(r),r=null,void t.removeAttr("disabled").removeClass("disabled").find("i").removeClass("fa-spin").end();e.click()}r=setTimeout(a,1e3)}t.length&&(i=!1,r=null,o=0,jQuery("button.retry").click(function(){i=!1;var t=jQuery(this),a=jQuery(this).data("entry-id"),n=jQuery("div#processing-entry-"+a),e=(t.attr("disabled","disabled").addClass("disabled").find("i").addClass("fa-spin").end(),r?n.find("div.queued").hide().end().find("div.processing").show().end():n.find("div.messages").children("div").hide().end().find("div.processing").show().end().end().hide().removeClass("hidden").slideDown("fast"),WHMCS.http.jqClient.post(window.location.pathname,{token:csrfToken,action:"retry",id:a},null,"json"));e.done(function(e){e.error&&(n.find("div.processing").hide().end().find("div.error").find("span").html(e.message).parent().show().end(),jQuery("#last-error-"+a).html(e.errorMessage),jQuery("div#entry-"+a).find("small.last-attempt").find("span").html(e.lastAttempt),t.removeAttr("disabled").removeClass("disabled").find("i").removeClass("fa-spin").end(),o++),e.completed&&(jQuery("div#entry-"+a).find("div.action-buttons").find("button").removeClass("retry").attr("disabled","disabled").addClass("disabled").find("i.fa-spin").removeClass("fa-spin").end(),n.find("div.processing").slideUp("fast").end().find("div.success").slideDown("fast").end())}),e.always(function(){i=!0})}),jQuery("button.resolve").click(function(){var t=jQuery(this),a=jQuery(this).data("entry-id"),n=jQuery("div#processing-entry-"+a);t.attr("disabled","disabled").addClass("disabled"),n.find("div.messages").children("div").hide().end().find("div.processing").show().end().end().hide().removeClass("hidden").slideDown("fast"),WHMCS.http.jqClient.post(window.location.pathname,{token:csrfToken,action:"resolve",id:a},null,"json").done(function(e){e.completed?(jQuery("div#entry-"+a).find("div.action-buttons").find("button").removeClass("retry").attr("disabled","disabled").addClass("disabled").end(),n.find("div.processing").slideUp("fast").end().find("div.success").find("span").html(e.message).parent().slideDown("fast").end()):(n.find("div.processing").slideUp("fast").end().find("div.error").find("span").html(e.message).parent().slideDown("fast").end(),t.removeAttr("disabled").removeClass("disabled"))})}),t.click(function(){jQuery(this).attr("disabled","disabled").addClass("disabled").find("i").addClass("fa-spin").end();var e=jQuery("button.retry");i=!0,o=0,e.each(function(e){var t=jQuery(this).data("entry-id");jQuery("div#processing-entry-"+t).find("div.messages").children("div").hide().end().find("div.queued").show().end().end().hide().removeClass("hidden").slideDown("fast")}),r=setTimeout(a,1e3)}))}),jQuery(document).ready(function(){jQuery(document).on("click","#btnMcServiceRefresh",function(e){e.preventDefault();var t=$(this);t.find("i").addClass("fa-spin"),WHMCS.http.jqClient.post({url:"clientsservices.php",data:t.attr("href")+"&token="+csrfToken,success:function(e){$("#mcServiceManagementWrapper").replaceWith(e.statusOutput),t.find("i").removeClass("fa-spin")}})}),jQuery(document).on("click","#btnMcCancelOrder",function(e){swal({title:"Are you sure?",html:!0,text:'Cancelling this order will result in the service immediately ceasing to function.<br><br>You will automatically receive a credit if within the credit period. <a href="https://go.whmcs.com/1281/marketconnect-credit-terms" target="_blank">See credit period terms</a>',type:"warning",showCancelButton:!0,confirmButtonText:"Yes, cancel it",cancelButtonText:"No"},function(){runModuleCommand("terminate")})}),jQuery(document).on("click","#mcServiceManagementWrapper .btn:not(.open-modal,.btn-refresh,.btn-cancel)",function(e){e.preventDefault(),$("#growls").fadeOut("fast").remove(),$(".successbox,.errorbox").slideUp("fast").remove();var e=$(this),t=e.attr("href"),a=e.find("i"),n=a.attr("class");"disabled"!==e.attr("disabled")&&(a.removeClass().addClass("fas fa-spin fa-spinner"),WHMCS.http.jqClient.post("clientsservices.php",t+"&token="+csrfToken,function(e){e.redirectUrl?window.open(e.redirectUrl):e.growl?"error"==e.growl.type?$.growl.error({title:"",message:e.growl.message}):($.growl.notice({title:"",message:e.growl.message}),$("#btnMcServiceRefresh").click()):($.growl.error({title:"",message:"Unknown response"}),console.error("[WHMCS] Unknown response: "+JSON.stringify(e)))},"json").fail(function(e){e=""!=e.responseText?e.responseText:e.statusText;$.growl.error({title:"",message:e})}).always(function(e){a.removeClass().addClass(n)}))}).on("click",".feature-menu-item",function(e){e.preventDefault();var e=jQuery(this),t=e.data("name"),a=jQuery(".feature-menu-item.shown"),n=jQuery(".feature-info-item.shown"),i=jQuery('.feature-info-item[data-name="'+t+'"]');a.removeClass("shown"),e.addClass("shown"),n.slideUp("fast",function(){jQuery(this).removeClass("shown"),i.hide().addClass("shown").slideDown("fast")})})}),jQuery(document).ready(function(){const t=new Map([["um","us"],["ic","es"],["gs","fk"],["aq","nf"],["tf","re"],["hm","nf"],["an","bq"],["pn","nz"]]);function o(e){return e=e.toLowerCase(),t.has(e)?t.get(e):e}if("undefined"!=typeof customCountryData){var e,a=$.fn.intlTelInput.getCountryData();for(e in customCountryData)if(customCountryData.hasOwnProperty(e)){var n=customCountryData[e];if(codeLower=e.toLowerCase(),!1===n){for(var i=0;i<a.length;i++)if(codeLower===a[i].iso2){a.splice(i,1);break}}else a.push({name:n.name,iso2:codeLower,dialCode:n.callingCode,priority:0,areaCodes:null})}}var r,s,d,l;jQuery("body").data("phone-cc-input")&&((r=jQuery('input[name^="phone"], input[name$="phone"], input[name="domaincontactphonenumber"]').not('input[type="hidden"]')).length&&(s=jQuery('[name^="country"], [name$="country"]'),d="us",s.length&&(d=o(s.val())),r.each(function(){var t=jQuery(this),a=t.attr("name");"domaincontactphonenumber"===a&&(d=jQuery('[name="domaincontactcountry"]').val().toLowerCase()),jQuery(this).before('<input id="populatedCountryCode'+a+'" type="hidden" name="country-calling-code-'+a+'" value="" />');try{t.intlTelInput({preferredCountries:[d,"us","gb"].filter(function(e,t,a){return a.indexOf(e)===t}),initialCountry:d,autoPlaceholder:"polite",separateDialCode:!0})}catch(e){return console.log(e.message),!1}t.on("countrychange",function(e,t){jQuery("#populatedCountryCode"+a).val(t.dialCode),jQuery(this).val()==="+"+t.dialCode&&jQuery(this).val("")}),t.on("blur keydown",function(e){var t;("blur"===e.type||"keydown"===e.type&&13===e.keyCode)&&(e=jQuery(this).intlTelInput("getNumber"),t="+"+jQuery(this).intlTelInput("getSelectedCountryData").dialCode,0===e.indexOf(t)&&1<(e.match(/\+/g)||[]).length&&(e=e.substr(t.length)),jQuery(this).intlTelInput("setNumber",e))}),jQuery("#populatedCountryCode"+a).val(t.intlTelInput("getSelectedCountryData").dialCode),s.on("change",function(){if(""===t.val()){var e=o(jQuery(this).val());try{r.intlTelInput("setCountry",e)}catch(e){return console.log(e.message),!1}}}),t.attr("data-initial-value",$(t).val()),t.parents("form").find("input[type=reset]").each(function(){var t=$(this).parents("form");$(this).data("phone-handler")||($(this).data("phone-handler",!0),$(this).click(function(e){return e.stopPropagation(),$(t).trigger("reset"),$(t).find("input[data-initial-value]").each(function(){$(this).val($(this).attr("data-initial-value"))}),!1}))})}),r.parents("div.form-group").find(".field-icon").hide().end(),r.removeClass("field").addClass("form-control")),(l=jQuery('input[name$="][Phone Number]"], input[name$="][Phone]"]').not('input[type="hidden"]')).length)&&jQuery.each(l,function(e,t){var a=jQuery(this),n=(n=a.attr("name")).replace("contactdetails[","").replace("][Phone Number]","").replace("][Phone]",""),i=jQuery('[name$="'+n+'][Country]"]'),r=o(i.val());a.before('<input id="populated'+n+'CountryCode" class="'+n+'customwhois" type="hidden" name="contactdetails['+n+'][Phone Country Code]" value="" />'),a.intlTelInput({preferredCountries:[r,"us","gb"].filter(function(e,t,a){return a.indexOf(e)===t}),initialCountry:r,autoPlaceholder:"polite",separateDialCode:!0}),a.on("countrychange",function(e,t){jQuery("#populated"+n+"CountryCode").val(t.dialCode),jQuery(this).val()==="+"+t.dialCode&&jQuery(this).val("")}),a.on("blur keydown",function(e){var t;("blur"===e.type||"keydown"===e.type&&13===e.keyCode)&&(e=jQuery(this).intlTelInput("getNumber"),t="+"+jQuery(this).intlTelInput("getSelectedCountryData").dialCode,0===e.indexOf(t)&&1<(e.match(/\+/g)||[]).length&&(e=e.substr(t.length)),jQuery(this).intlTelInput("setNumber",e))}),jQuery("#populated"+n+"CountryCode").val(a.intlTelInput("getSelectedCountryData").dialCode),i.on("blur",function(){var e;""===a.val()&&(e=o(jQuery(this).val()),a.intlTelInput("setCountry",e))})})});